{"id":"ig-03x","title":"Terminverwaltung \u0026 Scheduling System","description":"Epic für das komplette Terminverwaltungssystem der Zahnarztpraxis.\n\n## Ziel\nEin FHIR-natives Scheduling-System das:\n- Termine verwaltet (buchen, ändern, absagen)\n- Notfälle priorisiert einschiebt\n- Praxis-Constraints berücksichtigt (Räume, Personal, Behandlungsarten)\n- Voice-Agent-Integration ermöglicht\n\n## Referenz-Standards (primär)\n- **Argonaut Scheduling IG** (https://www.fhir.org/guides/argonaut/scheduling/) - FHIR Implementation Guide für Patient Scheduling. Definiert Workflows für Slot Discovery, Booking, Cancellation.\n- **SMART Scheduling Links** (https://github.com/smart-on-fhir/smart-scheduling-links) - Standard für externe Slot-Discovery. Ermöglicht Patienten, Termine über beliebige Booking-Tools zu finden.\n\n## FHIR Resources (nach Argonaut IG)\n- **Schedule** - Verfügbarkeitsplan pro Behandler/Raum\n- **Slot** - Einzelne buchbare Zeitfenster (free/busy/busy-unavailable)\n- **Appointment** - Gebuchter Termin mit Teilnehmern\n- **AppointmentResponse** - Bestätigung/Absage durch Teilnehmer\n\n## Praxis-Constraints (von Dirk Säger)\n- Anzahl Sprechzimmer\n- Anzahl Behandler + Assistenz\n- Behandlungsarten mit Dauern\n- Lange OPs binden Behandler komplett\n- Zwischen 01/Zst-Terminen ist Puffer\n- Füllungen sind zeitlich flexibel\n- Pausenzeiten-Regeln\n- Angebotene Terminlängen\n\n## Nicht relevant\n- Ottehr: Komplettes US-EHR, gebunden an Oystehr-Plattform, nicht modular nutzbar","status":"closed","priority":2,"issue_type":"epic","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:03:58.853283+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:42.873025+01:00","closed_at":"2026-02-06T08:51:42.873025+01:00","close_reason":"Scheduling-Epic zu umfangreich fuer Ignis-Abschluss, wird in Mira mit FHIR-nativem Ansatz neu konzipiert"}
{"id":"ig-06o","title":"[REFACTOR] SSE broadcaster has duplicated logic for appointment and queue events","description":"src/lib/sse-broadcaster.ts: broadcastAppointmentEvent() and broadcastQueueEvent() have nearly identical implementations. Extract shared broadcast logic into a generic helper.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:16.213438+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:16.213438+01:00"}
{"id":"ig-0fo","title":"POST /api/voice/authorize-action - Check if auth level permits action","description":"Check if the current authentication level is sufficient for the requested action. Used by ElevenLabs to determine if more verification is needed.\n\nInput: { \n  authLevel: 0 | 1 | 2 | 3,\n  action: 'view_appointment' | 'cancel_appointment' | 'change_phone' | 'request_prescription' | ...\n}\nOutput: { \n  authorized: boolean,\n  requiredLevel: number,\n  missingFactors?: ('postalCode' | 'streetName')[]\n}\n\nAction to Level mapping:\n- Level 0: greeting, practice_info\n- Level 1: view_appointment, confirm_reminder\n- Level 2: cancel_appointment, reschedule, change_phone, change_address\n- Level 3: request_prescription, request_referral, sick_note\n- Level 4: view_test_results (requires out-of-band, return cannotAuthorize: true)\n\nSee docs/AUTHENTICATION-POLICY.md for complete action mapping.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:24:49.708094+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T09:39:59.212576+01:00","closed_at":"2026-02-01T08:26:15.011776995+01:00","dependencies":[{"issue_id":"ig-0fo","depends_on_id":"ig-foa","type":"blocks","created_at":"2026-01-31T22:01:33.411989+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-0l7","title":"Seed-Daten: Demo Questionnaire + Responses für bestehende Patienten","description":"Seed-Daten erweitern um Questionnaire-Definition und stimmige QuestionnaireResponses.\n\n## Ist-Zustand Datenquellen\n1. aidbox/seed/demo-data.json - 3 handgemachte Patienten\n2. infra/load-synthea-data.sh - ~631 Synthea-Patienten (mit Conditions, Observations, Encounters - echte Krankengeschichten)\n3. scripts/seed-patients-today.ts - 11 Tages-Patienten mit Appointments/Queue\n\n## Synthea-Daten sind die Hauptquelle\nDie Synthea-Bundles enthalten pro Patient: Conditions, Observations, Encounters, MedicationRequests etc. Die QuestionnaireResponses muessen zu diesen Daten passen.\n\n## Zu erstellen\n\n### 1. Questionnaire-Definition (patient-intake-de)\nDeutsche Patientenaufnahme:\n- Versicherungsdaten (Kasse/Privat)\n- Aktuelle Beschwerden (Freitext)\n- Vorerkrankungen (Checkbox: Diabetes, Bluthochdruck, Asthma, etc.)\n- Allergien\n- Aktuelle Medikamente\n- Raucher/Alkohol (Ja/Nein)\n\n### 2. QuestionnaireResponse-Generator\nScript das:\n- Synthea-Patienten aus Aidbox liest (Conditions, MedicationRequests)\n- Daraus stimmige QuestionnaireResponses generiert\n- Z.B. Patient mit Condition 'Diabetes mellitus' -\u003e kreuz Diabetes an\n- Z.B. Patient mit MedicationRequest 'Metformin' -\u003e listet Metformin\n- Nicht alle Patienten bekommen Responses (realistisch: ~60-70%)\n- Manche Responses sind 'in-progress' (nicht fertig ausgefuellt)\n\n### 3. Integration\n- Questionnaire-Definition in demo-data.json oder separates Seed-Bundle\n- Response-Generator als Script (wie seed-patients-today.ts)\n- Idempotent (kann mehrfach laufen ohne Duplikate)\n\n## Abhaengigkeit\nBlockiert ig-b8j (PatientCard Questionnaire Status Indicator)","notes":"demo-data.json (3 handgemachte Patienten) kann entfernt werden - Synthea-Daten sind die einzige relevante Quelle. setup-aidbox.sh muss dann angepasst werden (kein Load von demo-data.json mehr).","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T09:08:23.872547+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:14.329476+01:00","closed_at":"2026-02-06T09:21:14.329476+01:00","close_reason":"Seed-Script + 26 Tests: 8 QuestionnaireResponses für Patienten 10-20, Condition/Medication-Mapping, idempotent via PUT"}
{"id":"ig-0qp","title":"[REFACTOR] TypeScript 'any' type usage in 3 locations","description":"Explicit 'any' types found at: (1) src/routes/voice.ts line 344 response object, (2) src/index.ts lines 121-134 WebSocket wrapper, (3) src/lib/chat-session.ts line 189 message handler. Replace with proper types.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:24.188721+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:24.188721+01:00"}
{"id":"ig-11a","title":"[GLOBAL] Release/Changelog Standard generalisieren","description":"Den Ignis release/changelog.md Standard generalisieren und in den globalen Claude-Config-Repo verschieben.\n\n## Ist-Zustand\nIgnis: .claude/standards/release/changelog.md\n- Fast schon generisch, nur Deploy-Zeile 6 ist Ignis-spezifisch (ssh root@ignis...)\n- Version-Locations (package.json) sind Bun/Node-spezifisch aber nicht Ignis-spezifisch\n\n## Soll-Zustand\nGlobal: ~/code/claude/malte/standards/release/changelog.md\n- SemVer + Keep-a-Changelog + Git Tags: universell\n- Deploy-Step als Platzhalter: 'Deploy gemaess Projekt-spezifischer Anleitung'\n- Version-Locations: Tabelle mit gaengigen Mustern (package.json, pyproject.toml, Cargo.toml)\n\n## Acceptance Criteria\n- [ ] Standard in globalem Repo\n- [ ] Deploy-Step generisch\n- [ ] Version-Locations fuer mehrere Stacks\n- [ ] Ignis release/changelog.md geloescht oder Verweis","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T15:32:10.21036+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:32:10.21036+01:00"}
{"id":"ig-18e","title":"[REFACTOR] extractPatientId() duplicated in aidbox-encounters.ts and aidbox-appointments.ts","description":"extractPatientId() helper that strips 'Patient/' prefix is duplicated in src/lib/aidbox-encounters.ts (line 136) and src/lib/aidbox-appointments.ts (line 138). Extract to shared FHIR utility.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:58.005299+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:09.556671+01:00"}
{"id":"ig-1cd","title":"Create script to generate FHIR Schedule/Slot/Appointment data","description":"Create a reusable script that uses Claude (haiku) to generate realistic FHIR Schedule, Slot, and Appointment data for testing the patient intake system. Should include appointment reasons/visit purposes.","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T20:45:28.283909+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T20:56:00.984738+01:00","closed_at":"2026-01-31T20:56:00.984738+01:00","close_reason":"Created infra/generate-appointments.sh - uses Claude Code with haiku to generate Schedule/Slot/Appointment data linked to patient Conditions"}
{"id":"ig-1d6","title":"Frontend: Voice Mode Toggle with Browser Audio","description":"Add voice toggle button and implement browser audio capture/playback for ElevenLabs voice mode","design":"-","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:54.358914+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:07:37.197367+01:00","closed_at":"2026-02-01T12:07:37.197367+01:00","close_reason":"Closed","dependencies":[{"issue_id":"ig-1d6","depends_on_id":"ig-e4h","type":"parent-child","created_at":"2026-02-01T10:25:01.651783+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-1d6","depends_on_id":"ig-3u7","type":"blocks","created_at":"2026-02-01T10:25:07.534709+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-1d6","depends_on_id":"ig-dgl","type":"blocks","created_at":"2026-02-01T10:58:36.425438+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-1f5","title":"Configure Aidbox FHIR server","description":"Setup Aidbox FHIR server with architecture-as-code approach:\n\n## Prerequisites\n- AIDBOX_LICENSE_ID and AIDBOX_LICENSE_KEY from https://aidbox.app\n\n## Implementation\n1. Update .env.example with Aidbox license vars\n2. Update docker-compose.yaml with correct Aidbox config\n3. Create aidbox/ directory with seed data\n4. Add infra/setup-aidbox.sh script that:\n   - Validates license keys are set\n   - Starts Aidbox container\n   - Waits for health check\n   - Loads demo FHIR resources\n\n## Demo Data\n- Sample Patient resources\n- Sample Practitioner resources\n- Sample Appointment resources\n- Basic FHIR R4 resources for practice workflow\n\n## Verification\n- Aidbox UI accessible at :8080\n- FHIR API responds at /fhir\n- Demo data queryable","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T14:52:40.633435+01:00","created_by":"mayor","updated_at":"2026-01-31T16:20:19.565301994+01:00","closed_at":"2026-01-31T16:10:32.938703+01:00","dependencies":[{"issue_id":"ig-1f5","depends_on_id":"ig-bpu","type":"blocks","created_at":"2026-01-31T14:52:48.312487+01:00","created_by":"mayor"}]}
{"id":"ig-1nb","title":"Backend: GET QuestionnaireResponse by Patient endpoint","description":"Add endpoint to fetch QuestionnaireResponse resources for a given patient ID","design":"-","notes":"Verified: 100% real FHIR - no stubs. getQuestionnaireResponsesByPatient uses fhirClient.get() to Aidbox.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:29:23.757546+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:04:23.321079+01:00","closed_at":"2026-02-01T11:55:59.298314869+01:00","dependencies":[{"issue_id":"ig-1nb","depends_on_id":"ig-swo","type":"parent-child","created_at":"2026-02-01T10:29:31.917242+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-23o","title":"Frontend: Implement useApiWithElevation hook","description":"Implement a React hook that wraps API calls and automatically handles elevation when 403 is returned.\n\n## Purpose\nFrontend components should NOT know which endpoints require which auth level. They just call the API, and if elevation is needed, the hook handles it automatically.\n\n## Hook Interface\n```typescript\nfunction useApiWithElevation() {\n  return {\n    request: \u003cT\u003e(path: string, options?: RequestInit) =\u003e Promise\u003cT\u003e,\n    elevationInfo: ElevationInfo | null,  // Non-null when dialog should show\n    onElevationComplete: () =\u003e void,       // Call after successful elevation\n  };\n}\n```\n\n## Behavior\n1. Component calls `request('/api/prescriptions', { method: 'POST', ... })`\n2. If 403 with `insufficient_level`:\n   - Store the pending request\n   - Set `elevationInfo` (triggers dialog)\n   - Return a Promise that waits\n3. User completes elevation dialog\n4. `onElevationComplete` is called\n5. Hook retries original request with new JWT\n6. Original Promise resolves\n\n## Implementation\n```typescript\nconst [pendingRequest, setPendingRequest] = useState\u003cPendingRequest | null\u003e(null);\nconst [elevationInfo, setElevationInfo] = useState\u003cElevationInfo | null\u003e(null);\n\nconst request = async \u003cT\u003e(path: string, options: RequestInit = {}): Promise\u003cT\u003e =\u003e {\n  try {\n    return await apiRequest\u003cT\u003e(path, options);\n  } catch (error) {\n    if (error instanceof ElevationRequiredError) {\n      setElevationInfo(error.elevationInfo.elevation);\n      return new Promise((resolve, reject) =\u003e {\n        setPendingRequest({ path, options, resolve, reject });\n      });\n    }\n    throw error;\n  }\n};\n```\n\n## Usage Example\n```tsx\nfunction PrescriptionButton() {\n  const { request, elevationInfo, onElevationComplete } = useApiWithElevation();\n\n  const handleClick = async () =\u003e {\n    // No knowledge of auth levels needed!\n    await request('/prescriptions', { method: 'POST', body: '...' });\n    toast.success('Done!');\n  };\n\n  return (\n    \u003c\u003e\n      \u003cButton onClick={handleClick}\u003eRequest\u003c/Button\u003e\n      {elevationInfo \u0026\u0026 (\n        \u003cElevationDialog\n          elevation={elevationInfo}\n          onSuccess={onElevationComplete}\n        /\u003e\n      )}\n    \u003c/\u003e\n  );\n}\n```\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:59:40.353922+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.148946+01:00","closed_at":"2026-02-06T08:51:29.148946+01:00","close_reason":"useApiWithElevation setzt Auth Level 4 voraus, wird in Mira weiterverfolgt","dependencies":[{"issue_id":"ig-23o","depends_on_id":"ig-c7o","type":"blocks","created_at":"2026-01-31T21:59:53.99803+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-24v","title":"Frontend: Implement ElevationDialog component","description":"Implement the ElevationDialog component that uses backend-provided prompts and factors.\n\n## Purpose\nDisplay a dialog when elevation is required. The dialog content (prompt, input type) comes from the backend's 403 response.\n\n## Props\n```typescript\ninterface ElevationDialogProps {\n  elevation: {\n    factors: string[];      // e.g., ['postalCode', 'city']\n    prompt: string;         // English prompt\n    promptDe: string;       // German prompt\n    requiresOtp?: boolean;  // If true, show OTP flow instead\n  };\n  onSuccess: () =\u003e void;    // Called after successful elevation\n  onCancel: () =\u003e void;     // Called if user cancels\n}\n```\n\n## Behavior\n1. Show dialog with backend-provided prompt (use German if browser locale is de-*)\n2. Render input for first factor in `factors` array\n3. On submit: POST /auth/elevate with { [factor]: value }\n4. On success: call `onSuccess()` (triggers request retry)\n5. On error: show error message, let user retry\n\n## Special Cases\n- If `requiresOtp` is true, render OtpElevationDialog instead\n- Use shadcn/ui Dialog component\n- Support loading state during elevation\n\n## Implementation\n```tsx\nfunction ElevationDialog({ elevation, onSuccess, onCancel }: Props) {\n  const prompt = navigator.language.startsWith('de')\n    ? elevation.promptDe\n    : elevation.prompt;\n\n  const factor = elevation.factors[0];\n\n  const handleSubmit = async () =\u003e {\n    const response = await fetch('/api/auth/elevate', {\n      method: 'POST',\n      headers: { Authorization: `Bearer ${jwt}` },\n      body: JSON.stringify({ [factor]: value }),\n    });\n    if (response.ok) {\n      const { jwt: newJwt, level } = await response.json();\n      elevate(newJwt, level);\n      onSuccess();\n    }\n  };\n\n  return (\n    \u003cDialog\u003e\n      \u003cDialogHeader\u003e{prompt}\u003c/DialogHeader\u003e\n      \u003cInput value={value} onChange={...} /\u003e\n      \u003cButton onClick={handleSubmit}\u003eVerify\u003c/Button\u003e\n    \u003c/Dialog\u003e\n  );\n}\n```\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:59:48.345955+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.238237+01:00","closed_at":"2026-02-06T08:51:29.238237+01:00","close_reason":"ElevationDialog setzt Auth Level 4 voraus, wird in Mira weiterverfolgt","dependencies":[{"issue_id":"ig-24v","depends_on_id":"ig-23o","type":"blocks","created_at":"2026-01-31T21:59:54.084084+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-2ch","title":"ElevenLabs: Configure authorize_action Tool","description":"Configure the authorize_action tool in ElevenLabs to check if actions are permitted.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** authorize_action\n\n**Description:**\nCheck if the current authentication level is sufficient for an action. Call this before performing any action to determine if more verification is needed. If not authorized, the response tells you what factors are missing.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"auth_level\": {\n      \"type\": \"integer\",\n      \"description\": \"Current authentication level (0=identified only, 1=birth date verified, 2=postal code verified, 3=street verified)\"\n    },\n    \"action\": {\n      \"type\": \"string\",\n      \"enum\": [\n        \"view_appointment\",\n        \"cancel_appointment\",\n        \"reschedule_appointment\",\n        \"book_appointment\",\n        \"change_phone\",\n        \"change_address\",\n        \"request_prescription\",\n        \"request_referral\",\n        \"request_sick_note\",\n        \"view_test_results\"\n      ],\n      \"description\": \"The action the patient wants to perform\"\n    }\n  },\n  \"required\": [\"auth_level\", \"action\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/voice/authorize-action\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n5. Save the tool\n\n## Expected Response Format\n\nAuthorized:\n```json\n{\n  \"authorized\": true,\n  \"requiredLevel\": 2\n}\n```\n\nNot authorized:\n```json\n{\n  \"authorized\": false,\n  \"requiredLevel\": 2,\n  \"currentLevel\": 0,\n  \"missingFactors\": [\"birthDate\", \"postalCode\"]\n}\n```\n\nCannot authorize (Level 4):\n```json\n{\n  \"authorized\": false,\n  \"requiredLevel\": 4,\n  \"cannotAuthorize\": true,\n  \"reason\": \"Requires human verification\"\n}\n```\n\n## Verification\n- Tool appears in agent's tool list\n- Test: auth_level=0, action=cancel_appointment returns authorized=false with missingFactors\n\n## Dependencies\nRequires: POST /api/voice/authorize-action endpoint (ig-0fo) to be implemented","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:28:07.564911+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:57:18.046128+01:00","closed_at":"2026-02-01T11:57:18.046128+01:00","close_reason":"Verified via ElevenLabs API - agent fully configured with system prompt, 9 tools, and Twilio phone integration","dependencies":[{"issue_id":"ig-2ch","depends_on_id":"ig-zoz","type":"blocks","created_at":"2026-01-31T22:00:50.412723+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-2ch","depends_on_id":"ig-0fo","type":"blocks","created_at":"2026-01-31T22:00:55.683344+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-2id","title":"Setup OpenClaw for practice messaging","description":"Install and configure OpenClaw (formerly ClawdBot) for AI-powered practice messaging.\n\n## Server Info\n- Server: 167.235.236.238 (ignis-hackathon)\n- SSH: hackathon@167.235.236.238\n- Project dir: /opt/ignis\n\n## Prerequisites\n- ig-bpu: Server setup (DONE)\n- ig-5co: Claim hackathon perks - need ElevenLabs and Hume API keys\n\n## What is OpenClaw?\nOpenClaw is an AI agent framework for voice/messaging bots. GitHub: https://github.com/openclaw/openclaw\n\n## Implementation Steps\n\n### 1. Research OpenClaw installation\n- Check OpenClaw GitHub repo for latest installation docs\n- Identify requirements (Node.js, Python, etc.)\n- Determine if Docker deployment is available\n\n### 2. Add OpenClaw to docker-compose.yaml\n```yaml\nopenclaw:\n  image: openclaw/openclaw:latest  # or build from source\n  environment:\n    - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY}\n    - HUME_API_KEY=${HUME_API_KEY}\n    - AIDBOX_URL=http://aidbox:8080\n    - AIDBOX_USER=${AIDBOX_ADMIN_ID}\n    - AIDBOX_PASSWORD=${AIDBOX_ADMIN_PASSWORD}\n  depends_on:\n    - aidbox\n  expose:\n    - \"3000\"\n```\n\n### 3. Update .env.example\nAdd placeholders for:\n- ELEVENLABS_API_KEY\n- HUME_API_KEY\n- OPENCLAW_WEBHOOK_SECRET\n\n### 4. Configure OpenClaw for FHIR integration\n- Connect to Aidbox FHIR API at http://aidbox:8080/fhir\n- Configure patient lookup via FHIR Patient resource\n- Setup appointment creation via FHIR Appointment resource\n\n### 5. Setup WhatsApp/Telegram integration\n- Configure messaging channel credentials\n- Test inbound message handling\n- Test outbound message sending\n\n### 6. Configure voice integration\n- Setup ElevenLabs for text-to-speech\n- Setup Hume AI for voice emotion detection (optional)\n- Configure voice response quality settings\n\n### 7. Add nginx route\nUpdate infra/nginx/nginx.conf:\n```nginx\nlocation /openclaw/ {\n    set $openclaw_upstream openclaw:3000;\n    rewrite ^/openclaw/(.*) /$1 break;\n    proxy_pass http://$openclaw_upstream;\n    # ... standard proxy headers\n}\n```\n\n### 8. Update setup-services.sh\n- Add OpenClaw health check\n- Add OpenClaw to final status output\n\n## Testing\n- [ ] OpenClaw container starts successfully\n- [ ] Health endpoint responds\n- [ ] Can query FHIR Patient via OpenClaw\n- [ ] Can create FHIR Appointment via OpenClaw\n- [ ] Voice synthesis working with ElevenLabs\n\n## Acceptance Criteria\n- [ ] OpenClaw running in docker-compose stack\n- [ ] Connected to Aidbox FHIR server\n- [ ] Accessible via nginx at /openclaw/\n- [ ] Voice integration configured\n- [ ] Basic patient intake flow working","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T14:52:38.391843+01:00","created_by":"mayor","updated_at":"2026-02-06T08:50:33.675137+01:00","closed_at":"2026-02-06T08:50:33.675137+01:00","close_reason":"OpenClaw nicht mehr relevant für Ignis - Background-Orchestration wird in Mira mit anderem Stack (Supervisor-Pattern) neu aufgesetzt.","dependencies":[{"issue_id":"ig-2id","depends_on_id":"ig-bpu","type":"blocks","created_at":"2026-01-31T14:52:48.213759+01:00","created_by":"mayor"},{"issue_id":"ig-2id","depends_on_id":"ig-5co","type":"blocks","created_at":"2026-01-31T14:52:48.261642+01:00","created_by":"mayor"}]}
{"id":"ig-2k6","title":"[IGNIS] /dod Command - Definition of Done Pruefung","description":"/dod Command mit Ignis-spezifischen Checks.\n\n## Kontext\nDas Command selbst ist projekt-spezifisch weil die konkreten Checks vom Stack abhaengen.\nDer DoD-Reminder Hook (ig-l7l) ist global und erinnert daran, /dod auszufuehren.\n\n## Ignis DoD-Checks\n1. Backend-Tests: bun test\n2. Frontend-Tests: cd frontend \u0026\u0026 bun run test\n3. TypeScript Check: tsc --noEmit (Backend + Frontend)\n4. Changelog: CHANGELOG.md aktualisiert bei Features/Fixes\n5. Security: Keine hardcoded Credentials\n6. View Impact: Alle betroffenen Views geprueft\n\n## Ziel-Ort\nIgnis: .claude/commands/dod.md\n\n## Acceptance Criteria\n- [ ] /dod Command in Ignis .claude/commands/\n- [ ] Fuehrt alle 6 Checks aus oder listet sie","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:33.207396+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:51.560388+01:00"}
{"id":"ig-2sp","title":"[REFACTOR] FHIRBundle interface defined in 4+ files - consolidate to shared type","description":"FHIRBundle interface is defined separately in src/lib/aidbox-patients.ts, src/lib/aidbox-voice.ts, src/lib/aidbox-auth.ts, src/lib/aidbox-medication-requests.ts (and possibly more). Each has slightly different shapes. Consolidate into src/lib/schemas.ts or a dedicated src/lib/fhir-types.ts.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:59.160361+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:11.807726+01:00"}
{"id":"ig-3ga","title":"Standard: Agent Briefing Template fuer Ignis","description":"Wiederverwendbares Briefing-Template fuer Agent-Prompts im Ignis-Projekt.\n\n## Problem\nJeder Agent-Prompt enthielt ~50 Zeilen repetitiven Kontext (Projektstruktur, Test-Commands, API-Funktionen, Dateipfade). DRY-Verletzung.\n\n## Standard-Inhalt\n- Projekt-Kontext Block (Tech Stack, Pfade)\n- Test-Commands Block (Backend: bun test, Frontend: cd frontend \u0026\u0026 bun run test)\n- Bestehende API-Funktionen und lib-Dateien\n- FHIR-Verbindungsdaten\n- TDD-Instruktionen\n\n## Dateien\n- NEU: .claude/standards/ignis/agent-briefing.md\n- UPDATE: .claude/standards/index.yml","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:43:54.961142+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:00:31.844399+01:00","closed_at":"2026-02-06T11:00:31.844399+01:00","close_reason":"Agent-Briefing Template mit Projekt-Kontext, Test-Commands, API-Funktionen (alle src/lib/ exports), FHIR-Daten, Route-Tabelle, Frontend-Komponenten, Prompt-Template, Deployment-Info"}
{"id":"ig-3ln","title":"POST /api/auth/initiate - Initiate magic link or SMS OTP authentication","description":"Initiate passwordless authentication via magic link (email) or SMS OTP. First step in frontend auth flow.\n\nInput: {\n  method: 'magic_link' | 'sms_otp',\n  identifier: string  // email or phone number\n}\nOutput: { \n  success: boolean, \n  expiresIn: number,  // seconds until token expires\n  maskedIdentifier: string  // e.g. 'm***@example.com'\n}\n\nImplementation:\n1. Validate identifier format (email or E.164 phone)\n2. Lookup patient by email (Patient.telecom where system=email) or phone\n3. If not found: return generic success (prevent enumeration)\n4. Generate secure token:\n   - Magic link: 256-bit random, store hash, 15min expiry\n   - SMS OTP: 6-digit numeric, store hash, 10min expiry\n5. Send via email provider or SMS provider\n6. Rate limit: 3 requests per hour per identifier\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:23:20.19244+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T22:16:32.012887+01:00","closed_at":"2026-01-31T22:16:32.012887+01:00","close_reason":"Implemented by parallel subagents"}
{"id":"ig-3u7","title":"Frontend: Chat Page UI Component","description":"Create /patient/chat page with chat message list, input field, and message bubbles","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:53.192424+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:42:51.813083+01:00","closed_at":"2026-02-01T11:42:51.813083+01:00","close_reason":"Closed","dependencies":[{"issue_id":"ig-3u7","depends_on_id":"ig-e4h","type":"parent-child","created_at":"2026-02-01T10:25:01.573573+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-3u7","depends_on_id":"ig-dgl","type":"blocks","created_at":"2026-02-01T10:58:36.256658+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-3x3","title":"Zahnartz-Feedback von Dirk Säger dokumentieren","description":"Feedback vom Zahnarzt Dirk Säger zu Notfällen, Voice-Interaktion und Praxis-Workflow festhalten.\n\n## Echte Notfälle (zeitnah behandeln)\n1. Schwellung im Gesicht (Abszess) + Unwohlsein/Fieber/schlechter AZ\n2. Blutung nach Extraktion\n3. Plötzliche starke Schmerzen an einzelnem Zahn (Verdacht retrograde Pulpitis)\n4. Lockerer Zahn durch parodontale Probleme - kann nicht mehr zubeißen\n5. Ältere Personen: durchgebrochene Prothese\n\n## Voice-Interaktion Überlegungen\n- Schweigepflicht-Problem: Man hört oft was im Nebenzimmer passiert\n- Lösung: Knopf im Ohr / Smart Glass + lokal gehosteter Agent\n- Für Hackathon: ElevenLabs nutzen, aber bewusst dass lokales Modell nötig vor Praxiseinsatz\n- Smart Glasses für jüngere Kollegen ohne Augenkorrektur/Lupenbrille geeignet\n\n## Praxis-Workflow Faktoren für Scheduling\n1. Anzahl Sprechzimmer\n2. Anzahl Behandler + Assistenz anwesend\n3. Geplante Behandlungen (Art, Dauer)\n4. Lange OPs (Implantate, Sinuslift) = ZA gebunden, kann nicht raus\n5. Zwischen 01-Untersuchungen, Zst (107, 105) ist immer Zeit\n6. Füllungsbehandlungen kann man abkürzen\n7. Ausweichen in Pausenzeit teilweise erlaubt?\n8. Welche Terminlängen werden angeboten?\n9. Gebrochene Prothese: Assistenz nimmt an, ZA entscheidet in 60s max","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:02:02.278514+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T08:04:49.725612+01:00","closed_at":"2026-02-01T08:04:49.725612+01:00","close_reason":"Feedback in separate Feature/Task-Tickets aufgeteilt: ig-9z9, ig-40h, ig-6kr, ig-jls, ig-wfi, ig-igs"}
{"id":"ig-40h","title":"FHIR Schedule/Slot Datenmodell implementieren","description":"Implementiere das FHIR-Datenmodell für Terminverwaltung in Aidbox basierend auf Argonaut Scheduling IG.\n\n## Referenz\n- **Argonaut Scheduling IG**: https://www.fhir.org/guides/argonaut/scheduling/\n- **SMART Scheduling Links**: https://github.com/smart-on-fhir/smart-scheduling-links\n\n## FHIR Resources\n\n### Schedule\n- Verfügbarkeitsplan pro Behandler und/oder Raum\n- Verknüpfung mit Practitioner, Location\n- Planungsperiode (planning horizon)\n- serviceCategory/serviceType für Behandlungsarten\n\n### Slot\n- Einzelne buchbare Zeitfenster\n- Status: free | busy | busy-unavailable | busy-tentative\n- Verknüpfung mit Schedule\n- serviceType für Behandlungsart\n- **SMART Scheduling Links kompatibel** für externe Discovery\n\n### Appointment\n- Gebuchter Termin\n- participant: Patient, Practitioner, Location\n- appointmentType: routine, walkin, checkup, followup, emergency\n- serviceType: Behandlungsart (01, Zst, Füllung, Implantation, etc.)\n- Status: proposed → pending → booked → fulfilled/cancelled/noshow\n\n### AppointmentResponse\n- Bestätigung/Absage durch Teilnehmer\n- participantStatus: accepted, declined, tentative, needs-action\n\n## API Endpoints (Argonaut-konform)\n- GET /fhir/Schedule - Verfügbare Schedules\n- GET /fhir/Slot?status=free\u0026start=ge...\u0026start=le... - Freie Slots finden (Argonaut $find operation)\n- POST /fhir/Appointment - Termin buchen (Argonaut $book operation)\n- PATCH /fhir/Appointment/:id - Termin ändern\n- DELETE /fhir/Appointment/:id - Termin absagen\n\n## Aidbox-spezifisch\n- Prüfen ob Argonaut Operations ($find, $book) in Aidbox verfügbar oder custom zu implementieren","notes":"Implemented: Backend routes now query real FHIR Slot/Schedule from Aidbox. aidbox-slots.ts: getSlotsForDate(), getNextSlots(), getSlotById(). GET /slots and /slots/next use Slot?status=free. POST /appointments uses slot reference. 12 tests pass.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:13.328598+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:42.969546+01:00","closed_at":"2026-02-06T08:51:42.969546+01:00","close_reason":"FHIR Schedule/Slot Datenmodell wird in Mira neu aufgesetzt","dependencies":[{"issue_id":"ig-40h","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.356437+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-4be","title":"[REFACTOR] patientDisplayName() duplicated in 3 places with slight variations","description":"Patient display name logic exists in 3 places: src/routes/patients.ts patientDisplayName() (line 33), src/routes/doctor.ts patientDisplayName() (line 25), src/lib/aidbox-voice.ts buildPatientDisplayName() (line 24). All do the same Herr/Frau mapping. Extract to shared utility.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:56.258323+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:07.664034+01:00"}
{"id":"ig-4gn","title":"[REFACTOR] Inconsistent validation patterns - zValidator vs manual JSON parsing","description":"Some routes use Zod zValidator middleware (patients.ts POST, PUT), while others do manual try/catch JSON.parse (queue.ts POST/PATCH). Standardize on zValidator for consistency and better error messages.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:21.510255+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:21.510255+01:00"}
{"id":"ig-4ol","title":"[GLOBAL] Changelog-Updater Agent","description":"Agent der automatisch CHANGELOG.md aus geschlossenen Beads aktualisiert.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/agents/changelog-updater/\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/agents/changelog-updater/\n- Changelog-Format: Keep a Changelog (bereits in release/changelog.md Standard definiert)\n- Agent liest geschlossene Beads, extrahiert Aenderungen, ordnet in Sektionen ein\n- Stack-agnostisch: Liest nur Bead-Metadaten und schreibt Markdown\n- Model: haiku (kostenguenstig, reicht fuer Changelog-Generierung)\n\n## Acceptance Criteria\n- [ ] Agent in globalem Claude-Config-Repo (agent.yml + prompt.md)\n- [ ] Liest Beads via bd list/show\n- [ ] Generiert Keep-a-Changelog konforme Eintraege\n- [ ] Tools: Bash, Read, Edit","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:35.604291+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:16.098564+01:00"}
{"id":"ig-4sg","title":"ElevenLabs: Configure get_patient_appointments Tool","description":"Configure the get_patient_appointments tool to query a patient's upcoming appointments.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** get_patient_appointments\n\n**Description:**\nGet the patient's upcoming appointments. Use this when the patient asks about their next appointment or wants to know when they're scheduled. Requires Level 1 authentication (birth date verified).\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID from identify_patient\"\n    },\n    \"auth_level\": {\n      \"type\": \"integer\",\n      \"description\": \"Current authentication level (must be \u003e= 1)\"\n    }\n  },\n  \"required\": [\"patient_id\", \"auth_level\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/appointments?patientId=${patient_id}\n- Method: GET\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n\n## Expected Response\n```json\n{\n  \"appointments\": [\n    {\n      \"id\": \"apt-123\",\n      \"date\": \"2026-02-15\",\n      \"time\": \"10:00\",\n      \"practitioner\": \"Dr. Müller\",\n      \"type\": \"Vorsorgeuntersuchung\"\n    }\n  ]\n}\n```\n\n## Voice Response Example\n'Ihr nächster Termin ist am 15. Februar um 10 Uhr bei Dr. Müller zur Vorsorgeuntersuchung.'\n\n## Authentication\nRequires Level 1 (birth date verified). Check auth_level before using.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:28:49.893701+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:13.345119+01:00","closed_at":"2026-02-01T12:02:13.345119+01:00","close_reason":"Different approach taken: patient_lookup tool returns upcomingAppointment field instead of separate get_patient_appointments tool","dependencies":[{"issue_id":"ig-4sg","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:03.764188+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-4tp","title":"ElevenLabs: Create Conversational AI Agent","description":"Create a new Conversational AI agent in the ElevenLabs dashboard for the Ignis voice assistant.\n\n## Steps\n\n1. Go to https://elevenlabs.io/app/conversational-ai\n2. Click 'Create Agent'\n3. Configure basic settings:\n   - Name: 'Ignis Praxis Assistant'\n   - Language: German (de-DE)\n   - Voice: Select appropriate German voice (e.g., 'Nicole' or custom)\n   - First message: 'Einen Moment bitte, ich schaue nach wer Sie sind...'\n\n4. Set conversation settings:\n   - Model: claude-3-5-sonnet or gpt-4o (for tool calling support)\n   - Temperature: 0.7 (balanced between consistency and naturalness)\n   - Max tokens: 150 (keep responses concise for phone)\n\n5. Enable 'Tool Use' in the agent settings\n\n## Verification\n- Agent created and visible in dashboard\n- Test voice output sounds natural in German\n- Tool use is enabled\n\n## Next Steps\nAfter creating the agent, configure the system prompt (ig-xxx) and tools (ig-xxx).","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:27:41.662305+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T22:02:36.67337+01:00","closed_at":"2026-01-31T22:02:36.67337+01:00","close_reason":"Agent already created in ElevenLabs dashboard"}
{"id":"ig-4uy","title":"[GLOBAL] View Impact Check Standard generalisieren","description":"Den Ignis-spezifischen frontend/view-impact-check.md Standard generalisieren und in den globalen Claude-Config-Repo verschieben.\n\n## Ist-Zustand\nIgnis: .claude/standards/frontend/view-impact-check.md\n- Enthält hardcoded Ignis-Views (patient-table, wartezimmer, dashboard, termine)\n- Regeln sind generisch anwendbar\n\n## Soll-Zustand\nGlobal: ~/code/claude/malte/standards/frontend/view-impact-check.md\n- Gleiche Regeln, aber ohne projekt-spezifische Dateinamen\n- Checkliste wird zum Prozess: 'grep nach Datentyp, liste alle Views, extrahiere bei 2+'\n- Projekt-spezifische View-Listen gehoeren in Projekt-Standards (z.B. agent-briefing.md)\n\n## Acceptance Criteria\n- [ ] Standard in globalem Repo, ohne hardcoded Views\n- [ ] Ignis view-impact-check.md geloescht oder zu Verweis auf global umgebaut\n- [ ] index.yml Trigger global","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T15:32:03.809182+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:32:03.809182+01:00"}
{"id":"ig-5co","title":"Claim hackathon perks","description":"Claim and configure API keys:\n- ElevenLabs (3 months Creator) - Voice\n- Hume AI (Creator mode) - Alternative voice\n- n8n (1 month Pro) - Workflows\n- OpenAI ($50 credits) - Backup LLM\n- LangChain ($50 LangSmith) - Tracing\n- Google DeepMind ($5 GCP)","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T14:52:36.375492+01:00","created_by":"mayor","updated_at":"2026-02-06T08:49:34.712251+01:00","closed_at":"2026-02-06T08:49:34.712251+01:00","close_reason":"Hackathon abgeschlossen, Perks nicht mehr relevant."}
{"id":"ig-5mr","title":"Make room assignments configurable","description":"dashboard-waiting-queue.tsx has hardcoded rooms ['Raum 1', 'Raum 2', 'Raum 3']. Move to environment config or fetch from /api/config/rooms.","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:16.149849+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.399358+01:00","closed_at":"2026-02-06T08:51:29.399358+01:00","close_reason":"Raumzuweisung ist nice-to-have, nicht relevant fuer Ignis-Abschluss"}
{"id":"ig-5qt","title":"Create ElevenLabs agent config sync (export/import)","description":"Create scripts to sync ElevenLabs agent configuration with git:\n\n1. Export script: Fetch agent config via API and save to elevenlabs/agent-config.json\n2. Import script: Update ElevenLabs agent from local config file\n3. Consider splitting into separate files:\n   - elevenlabs/system-prompt.md (easier to edit)\n   - elevenlabs/tools/*.json (one per tool)\n   - elevenlabs/agent-settings.json (voice, timeouts, etc.)\n\nAPI endpoint: GET/PATCH https://api.elevenlabs.io/v1/convai/agents/{agent_id}\nAgent ID: agent_8101kgaq3e85ecqay2ctsjgp0y2e\n\nBenefits:\n- Version control for agent config\n- AI agents can update prompts/tools programmatically\n- Backup and disaster recovery\n- Code review for prompt changes","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T11:57:52.666132+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:04:12.272808+01:00","closed_at":"2026-02-01T12:04:12.272808+01:00","close_reason":"Created export-agent.ts and import-agent.ts scripts. Exported current config to elevenlabs/ directory with separate files for system prompt, tools, and settings."}
{"id":"ig-600","title":"ElevenLabs: Configure register_emergency Tool","description":"Configure the register_emergency tool for life-threatening situations.\n\n## CRITICAL: This tool handles emergencies - configure carefully!\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** register_emergency\n\n**Description:**\nEMERGENCY: Register an emergency and instruct the patient to call 112 immediately. Use this tool when the patient describes life-threatening symptoms. This tool logs the emergency and notifies staff, but the AI must ALWAYS tell the patient to hang up and call 112.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"phone\": {\n      \"type\": \"string\",\n      \"description\": \"Caller's phone number\"\n    },\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"Patient ID if known (optional)\"\n    },\n    \"symptoms\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"string\" },\n      \"description\": \"Emergency symptoms described\"\n    },\n    \"severity\": {\n      \"type\": \"string\",\n      \"enum\": [\"critical\", \"severe\"],\n      \"description\": \"Severity assessment\"\n    }\n  },\n  \"required\": [\"phone\", \"symptoms\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/queue/emergency\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Emergency Detection Keywords\nTrigger this tool when patient mentions:\n- Chest pain / Brustschmerzen\n- Difficulty breathing / Atemnot\n- Severe bleeding / starke Blutung\n- Loss of consciousness / Bewusstlosigkeit\n- Stroke symptoms (face drooping, arm weakness, speech difficulty)\n- Severe allergic reaction / Anaphylaxie\n- Suicidal thoughts / Suizidgedanken\n\n## MANDATORY Voice Response\n'Dies klingt nach einem Notfall. Bitte legen Sie sofort auf und rufen Sie den Notruf 112 an. Ich wiederhole: Rufen Sie jetzt 112 an. Unsere Praxis wird ebenfalls informiert.'\n\n## Authentication\nNO AUTHENTICATION REQUIRED - patient safety takes priority.\n\n## Logging\nAll emergency calls are logged with timestamp, caller ID, and symptoms for follow-up.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:19.321618+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:09.186592+01:00","closed_at":"2026-02-01T12:02:09.186592+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-600","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:04.093097+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-62y","title":"[REFACTOR] Frontend: FHIRPatient type differs between backend and frontend","description":"FHIRPatient is defined in both src/lib/schemas.ts (backend, Zod schema) and frontend/lib/api.ts (plain TypeScript interface). The shapes differ slightly. This can cause runtime mismatches when the API response doesn't match frontend expectations.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:02:01.366422+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:02:01.366422+01:00"}
{"id":"ig-6aj","title":"[GLOBAL] Infrastructure-First Team-Workflow Standard","description":"Standard der das Infrastructure-First Pattern fuer Agent-Teams beschreibt.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/standards/project/team-workflow.md\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/standards/project/team-workflow.md\n- Konzept ist tech-agnostisch: Erst Infrastruktur (Tests, Types, Interfaces), dann Implementierung\n- Beispiele generalisieren: Statt conftest.py -\u003e 'test setup files', statt __init__.py -\u003e 'barrel exports / module boundaries'\n- Parallel-Agent Patterns dokumentieren (aus Ignis-Erfahrung: 4 Agents parallel bewaehrt)\n\n## Acceptance Criteria\n- [ ] Standard in globalem Claude-Config-Repo\n- [ ] Stack-agnostische Formulierung\n- [ ] Agent-Team Best Practices aus Ignis + Zahnrad Erfahrung","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:30.13973+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:10.941762+01:00"}
{"id":"ig-6kr","title":"Praxis-Konfiguration für Scheduling","description":"Konfigurierbare Praxis-Parameter für das Scheduling-System.\n\n## Zu konfigurierende Parameter (basierend auf Dirk Säger Feedback)\n\n### Ressourcen\n- Anzahl Sprechzimmer (Locations)\n- Behandler (Practitioners) mit Spezialisierungen\n- Assistenz-Personal und Zuordnung\n\n### Behandlungsarten mit Constraints\n- Art der Behandlung (serviceType)\n- Standard-Dauer\n- Benötigte Ressourcen (Raum, Personal)\n- Flexibilität (abkürzbar ja/nein)\n- Behandler-Bindung (kann unterbrochen werden?)\n\n### Beispiele\n| Behandlung | Dauer | Flexibel | Unterbrechbar |\n|------------|-------|----------|---------------|\n| 01-Untersuchung | 15min | ja | ja |\n| Zst (107, 105) | 20min | ja | ja |\n| Füllung | 30min | ja (abkürzbar) | bedingt |\n| Implantation | 90min | nein | nein |\n| Sinuslift | 120min | nein | nein |\n\n### Zeitregeln\n- Angebotene Terminlängen (15, 30, 45, 60, 90, 120 min)\n- Pufferzeiten zwischen Terminen\n- Pausenzeiten (wann darf ausgewichen werden?)\n- Öffnungszeiten pro Wochentag\n\n## Datenmodell\n- PracticeSettings Resource (custom oder Extension)\n- Oder als Aidbox Configuration","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:21.507562+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:43.052566+01:00","closed_at":"2026-02-06T08:51:43.052566+01:00","close_reason":"Praxis-Konfiguration wird in Mira neu aufgesetzt","dependencies":[{"issue_id":"ig-6kr","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.436787+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-6m1","title":"Demo Materials - Pitch deck, script, and German seed data","description":"Create comprehensive demo materials: pitch deck (5-7 slides), detailed demo script, realistic German seed data (Ärzte, schedules, sample patients with German names/addresses), backup video recording. Essential for presentation.","status":"closed","priority":1,"issue_type":"task","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:30.398821+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:49:32.650211+01:00","closed_at":"2026-02-06T08:49:32.650211+01:00","close_reason":"Hackathon gewonnen, Demo-Materials nicht mehr nötig für Ignis. Pitch-Ansatz wird in Mira weiterverfolgt."}
{"id":"ig-6xd","title":"POST /api/voice/identify - Lookup patient by Caller-ID","description":"Lookup patient in FHIR by phone number (Caller-ID). Returns patient name and ID if found, enabling personalized greeting. This is Level 0 authentication - identification only, no sensitive data access.\n\nInput: { callerPhoneNumber: string }\nOutput: { found: boolean, patientId?: string, patientName?: string }\n\nImplementation:\n1. Normalize phone number format\n2. Query FHIR: Patient?telecom={phone}\n3. Return patient basic info if found\n4. Log lookup attempt (GDPR-compliant)\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:24:40.798825+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T22:16:31.979639+01:00","closed_at":"2026-01-31T22:16:31.979639+01:00","close_reason":"Implemented by parallel subagents"}
{"id":"ig-6yy","title":"[REFACTOR] todayBerlin() duplicated in 4 files - extract to shared utility","description":"todayBerlin() is copy-pasted in: src/routes/appointments.ts (line 53), src/lib/aidbox-appointments.ts (line 131), src/lib/aidbox-encounters.ts (line 131), src/lib/demo-setup.ts. Extract to a shared date utility (e.g. src/lib/date-utils.ts).","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:54.194748+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:04.006877+01:00"}
{"id":"ig-7gv","title":"ElevenLabs: Configure identify_patient Tool","description":"Configure the identify_patient tool in ElevenLabs to look up patients by Caller-ID.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** identify_patient\n\n**Description:**\nLook up a patient by their phone number. Call this at the start of every conversation to personalize the greeting. Returns patient name if found.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"caller_phone\": {\n      \"type\": \"string\",\n      \"description\": \"The caller's phone number in E.164 format (e.g., +491719876543)\"\n    }\n  },\n  \"required\": [\"caller_phone\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/voice/identify\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n5. Set 'Call on conversation start' = true (if available)\n6. Save the tool\n\n## Expected Response Format\n```json\n{\n  \"found\": true,\n  \"patientId\": \"patient-2\",\n  \"patientName\": \"Maria Weber\"\n}\n```\n\n## Verification\n- Tool appears in agent's tool list\n- Test call triggers the tool automatically\n\n## Dependencies\nRequires: POST /api/voice/identify endpoint (ig-6xd) to be implemented","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:27:52.205483+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:57:18.010047+01:00","closed_at":"2026-02-01T11:57:18.010047+01:00","close_reason":"Verified via ElevenLabs API - agent fully configured with system prompt, 9 tools, and Twilio phone integration","dependencies":[{"issue_id":"ig-7gv","depends_on_id":"ig-zoz","type":"blocks","created_at":"2026-01-31T22:00:50.25057+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-7gv","depends_on_id":"ig-6xd","type":"blocks","created_at":"2026-01-31T22:00:55.523274+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-84","title":"Configure remote Aidbox access for developers","description":"Setup Aidbox so developers can connect from their local Bun backend without running it locally.\n\n## Server Status\n- Aidbox running on: 167.235.236.238:8080\n- Credentials: admin / ignis2026\n\n## Tasks\n1. Expose Aidbox externally (currently localhost only)\n   - Option A: nginx reverse proxy with auth\n   - Option B: Direct port exposure (simple but less secure)\n2. Create .env.development with remote Aidbox URL\n3. Document connection setup for devs\n4. Test from local Bun backend\n\n## Developer Connection\n```\nAIDBOX_URL=http://167.235.236.238:8080\nAIDBOX_USER=admin\nAIDBOX_PASSWORD=ignis2026\n```","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T15:50:00+01:00","updated_at":"2026-01-31T16:20:19.57488766+01:00","closed_at":"2026-01-31T16:10:34.430336+01:00"}
{"id":"ig-85","title":"Create Miro pitch deck (5 slides)","description":"Create 5 Miro slides for hackathon pitch. 2 min pitch, 2 min demo, 2 min Q\u0026A.\n\n## Slide 1: The Market Problem\n- Who: ~100,000 German medical practices (Arztpraxen)\n- Problem: 30-40% staff time on phone admin, 12 min avg patient wait\n- Current solution: Phone + paper intake - slow, error-prone, language barriers\n\n## Slide 2: Your Solution\n- One sentence: AI voice agent that handles patient intake calls 24/7\n- 10x better: Instant response, multilingual, 3-tier triage, never sleeps\n\n## Slide 3: Business Model\n- Who pays: Medical practices (B2B SaaS)\n- Pricing: Per practice per month OR per call\n\n## Slide 4: Go-to-Market Plan\n- First 10 customers: Personal network in Hamburg medical community\n- Distribution: Partner with PVS vendors\n\n## Slide 5: Why You / Why Now\n- Team background\n- 48h learnings\n- Why now: AI voice quality finally good enough","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T15:50:00+01:00","updated_at":"2026-01-31T19:50:02.379918+01:00","closed_at":"2026-01-31T19:50:02.379918+01:00","close_reason":"Erste Version des Pitch Decks in Miro fertiggestellt"}
{"id":"ig-86","title":"Setup DNS and SSL for ignis.cognovis.de","description":"Configure DNS and SSL for production-ready external access.\n\n## DNS Setup\n- Domain: ignis.cognovis.de\n- Point A record to: 167.235.236.238\n- Malte to configure in cognovis.de DNS\n\n## SSL Setup (Let's Encrypt)\n1. Update nginx config for domain\n2. Install certbot in Docker or use acme.sh\n3. Auto-renew certificates\n\n## Implementation\n1. Add DOMAIN variable to .env\n2. Update setup-services.sh to accept domain parameter\n3. Update nginx.conf template with domain\n4. Add SSL certificate provisioning script\n5. Configure automatic HTTP-\u003eHTTPS redirect\n\n## Endpoints after setup\n- https://ignis.cognovis.de/aidbox/\n- https://ignis.cognovis.de/fhir/\n- https://ignis.cognovis.de/n8n/","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T16:00:00+01:00","created_by":"mayor","updated_at":"2026-01-31T16:10:35.878299+01:00","closed_at":"2026-01-31T16:10:35.113893+01:00"}
{"id":"ig-87","title":"Implement SSL with Let's Encrypt for ignis.cognovis.de","description":"Add automated SSL certificate provisioning using Let's Encrypt/certbot.\n\n## Prerequisites\n- DNS A record: ignis.cognovis.de -\u003e 167.235.236.238 (Malte to configure)\n- Port 80 and 443 open (already done via ufw)\n\n## Implementation Steps\n\n### 1. Add DOMAIN variable to .env.example\n```\n# Domain configuration (leave empty for IP-only access)\nDOMAIN=ignis.cognovis.de\nSSL_EMAIL=malte@cognovis.de\n```\n\n### 2. Create infra/setup-ssl.sh script\n```bash\n#!/bin/bash\n# Usage: ./setup-ssl.sh [domain] [email]\n# - Installs certbot if needed\n# - Requests Let's Encrypt certificate\n# - Configures nginx for HTTPS\n# - Sets up auto-renewal cron job\n```\n\nScript should:\n- Check if DOMAIN is set in .env or passed as argument\n- Verify DNS resolves to this server's IP\n- Stop nginx temporarily for standalone certbot\n- Request certificate: certbot certonly --standalone -d $DOMAIN --email $SSL_EMAIL --agree-tos --non-interactive\n- Copy certs to ./infra/ssl/ directory\n- Restart nginx with SSL config\n- Add cron for renewal: 0 3 * * * certbot renew --quiet\n\n### 3. Create infra/nginx/nginx-ssl.conf template\n```nginx\nserver {\n    listen 80;\n    server_name ${DOMAIN};\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name ${DOMAIN};\n\n    ssl_certificate /etc/nginx/ssl/fullchain.pem;\n    ssl_certificate_key /etc/nginx/ssl/privkey.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n    ssl_prefer_server_ciphers off;\n\n    # ... rest of proxy config\n}\n```\n\n### 4. Update docker-compose.yaml\n- Add port 443 to nginx service\n- Add volume mount for SSL certs: ./infra/ssl:/etc/nginx/ssl:ro\n- Add volume mount for nginx-ssl.conf when DOMAIN is set\n\n### 5. Update infra/setup-services.sh\n- After starting services, check if DOMAIN is set\n- If set, call setup-ssl.sh automatically\n- Update final output to show https:// URLs\n\n### 6. Update cloud-init.yaml\n- Install certbot package\n- Open port 443 in ufw\n\n## Testing\n1. Set DNS: ignis.cognovis.de -\u003e 167.235.236.238\n2. Wait for DNS propagation (check with: dig ignis.cognovis.de)\n3. Run: ./infra/setup-ssl.sh ignis.cognovis.de malte@cognovis.de\n4. Verify: curl -I https://ignis.cognovis.de/fhir/Patient\n\n## Files to create/modify\n- [ ] .env.example - add DOMAIN, SSL_EMAIL\n- [ ] infra/setup-ssl.sh - new script\n- [ ] infra/nginx/nginx-ssl.conf - SSL template\n- [ ] docker-compose.yaml - add port 443, ssl volume\n- [ ] infra/setup-services.sh - integrate SSL setup\n- [ ] infra/cloud-init.yaml - add certbot, port 443\n\n## Acceptance Criteria\n- [ ] HTTPS works at https://ignis.cognovis.de/\n- [ ] HTTP redirects to HTTPS\n- [ ] Certificate auto-renews\n- [ ] Setup is fully automated via scripts\n- [ ] Works for any domain (configurable)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T16:00:00+01:00","created_by":"mayor","updated_at":"2026-01-31T16:48:35.308371582+01:00","closed_at":"2026-01-31T16:17:46.34863+01:00"}
{"id":"ig-8id","title":"Setup Vitest for frontend testing","description":"Install and configure Vitest with React Testing Library for frontend unit/component testing. Backend uses Bun Test for integration tests, frontend should use Vitest for component tests.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T20:58:06.129942+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T21:01:31.369178+01:00","closed_at":"2026-01-31T21:01:31.369178+01:00","close_reason":"Setup complete: Vitest + React Testing Library configured with sample test"}
{"id":"ig-8u9","title":"[REFACTOR] Frontend: appointments-store.ts may be unused (replaced by use-appointments hook)","description":"frontend/lib/appointments-store.ts is a Zustand store with hardcoded mock appointment data. The app now uses real API data via the use-appointments hook with SSE. Verify if this store is still imported anywhere; if not, remove it.","status":"open","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:56.438502+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:56.438502+01:00"}
{"id":"ig-8x2","title":"ElevenLabs: Configure request_callback Tool","description":"Configure the request_callback tool for general callback requests.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** request_callback\n\n**Description:**\nRequest a callback from the practice. Use this when the patient wants to speak to a human, has a question that requires staff assistance, or when the AI cannot help with their request.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"phone\": {\n      \"type\": \"string\",\n      \"description\": \"Callback phone number\"\n    },\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"Patient ID if known (optional)\"\n    },\n    \"reason\": {\n      \"type\": \"string\",\n      \"description\": \"Reason for callback request\"\n    },\n    \"category\": {\n      \"type\": \"string\",\n      \"enum\": [\"prescription\", \"results\", \"insurance\", \"billing\", \"general\", \"other\"],\n      \"description\": \"Category of the request\"\n    },\n    \"preferred_time\": {\n      \"type\": \"string\",\n      \"description\": \"Preferred callback time (morning, afternoon, specific time)\"\n    }\n  },\n  \"required\": [\"phone\", \"reason\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/callback\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"callbackId\": \"cb-789\",\n  \"estimatedTime\": \"within 2 hours\"\n}\n```\n\n## Use Cases\n- Patient asks about test results (category: results)\n- Patient needs prescription refill (category: prescription)\n- Insurance/billing questions (category: insurance/billing)\n- Complex questions AI cannot answer (category: other)\n- Patient explicitly asks for human (category: general)\n\n## Voice Response Example\n'Ich habe einen Rückruf für Sie angefordert. Ein Mitarbeiter wird Sie innerhalb von 2 Stunden zurückrufen. Gibt es sonst noch etwas, wobei ich Ihnen helfen kann?'\n\n## Authentication\nLevel 1 recommended for known patients, but can accept requests from unknown callers with just phone number.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:26.797141+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:27.702094+01:00","closed_at":"2026-02-01T12:02:27.702094+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-8x2","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:04.175279+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-8yb","title":"[REFACTOR] Frontend: Queue fetching/polling logic duplicated in wartezimmer and dashboard","description":"Same fetchQueue() + useEffect polling pattern (10s interval) exists in both frontend/app/wartezimmer/page.tsx and frontend/components/dashboard-waiting-queue.tsx. Extract to a custom hook e.g. useQueueData().","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:46.030975+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:46.030975+01:00"}
{"id":"ig-92d","title":"ElevenLabs: Configure book_appointment Tool","description":"Configure the book_appointment tool to book appointments via voice.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** book_appointment\n\n**Description:**\nBook an appointment for the patient. Use this after the patient has selected a date/time and you have verified their identity to Level 2. Always confirm the details before booking.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID from identify_patient\"\n    },\n    \"slot_id\": {\n      \"type\": \"string\",\n      \"description\": \"The slot ID from available slots\"\n    },\n    \"auth_level\": {\n      \"type\": \"integer\",\n      \"description\": \"Current authentication level (must be \u003e= 2)\"\n    },\n    \"reason\": {\n      \"type\": \"string\",\n      \"description\": \"Reason for the appointment (optional)\"\n    }\n  },\n  \"required\": [\"patient_id\", \"slot_id\", \"auth_level\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/appointments\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"appointment\": {\n    \"id\": \"apt-456\",\n    \"date\": \"2026-02-20\",\n    \"time\": \"14:30\",\n    \"practitioner\": \"Dr. Müller\"\n  }\n}\n```\n\n## Voice Response Example\n'Ich habe Ihren Termin am 20. Februar um 14:30 Uhr bei Dr. Müller gebucht. Sie erhalten eine Bestätigung per SMS.'\n\n## Authentication\nRequires Level 2 (birth date + postal code verified).","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:28:56.030473+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:09.202152+01:00","closed_at":"2026-02-01T12:02:09.202152+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-92d","depends_on_id":"ig-f4d","type":"blocks","created_at":"2026-01-31T22:01:03.847821+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-96p","title":"MFA-Review Dashboard: KI-Einschätzungen mit Learning Loop","description":"Die MFA sieht im Dashboard angereicherte Informationen zu eingehenden Anrufen:\n\n**Was die KI liefert (administrative Priorisierung, KEIN klinisches Urteil):**\n- Erkannte Keywords (z.B. 'Brustschmerzen', 'Atemnot') \n- Patientenhistorie ('war gestern mit gleichen Symptomen da')\n- Administrative Prioritäts-Vorschlag (Notfall/Dringend/Normal)\n\n**Was die MFA macht:**\n- Sieht die KI-Einschätzung als Vorschlag\n- Entscheidet selbst über Priorität\n- Kann KI-Vorschlag übernehmen oder ändern\n\n**Learning Loop:**\n- System erfasst ob MFA den KI-Vorschlag übernommen oder geändert hat\n- Supervisor-Analyse: Welche Muster bei Abweichungen?\n- Confidence-Schwellen werden iterativ angepasst\n- Vorbild: solutio Support-Agent Lern-Loop (Q2026_02_0001)\n\n**Regulatorische Positionierung:**\n- 'Administrative Workflow-Software' - NICHT 'klinisches Triage-System'\n- Default: Patient bleibt in normaler Warteschlange (kein automatisches Handeln)\n- MFA hat volle Entscheidungshoheit (Human-in-the-Loop)\n- Vermeidet MDR-Klassifizierung durch deklarierte Zweckbestimmung","status":"closed","priority":1,"issue_type":"feature","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:22.462767+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:55:09.490275+01:00","closed_at":"2026-02-06T08:55:09.490275+01:00","close_reason":"MFA-Review + Learning Loop wird in Mira-Projekt weiterverfolgt (Compliance-Framework mira-dyt)."}
{"id":"ig-9gx","title":"Backend: QuestionnaireResponse FHIR Storage","description":"Create endpoint to store chat-collected questionnaire answers as FHIR QuestionnaireResponse resources","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:52.292091+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:29:15.169041+01:00","closed_at":"2026-02-01T11:17:24.006797517+01:00","dependencies":[{"issue_id":"ig-9gx","depends_on_id":"ig-e4h","type":"parent-child","created_at":"2026-02-01T10:25:01.496791+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-9tb","title":"[REFACTOR] Frontend: progressStatus and cyclePriority duplicated in queue views","description":"progressStatus() and cyclePriority() interaction handlers are nearly identical in frontend/app/wartezimmer/page.tsx and frontend/components/dashboard-waiting-queue.tsx. Both do optimistic updates + API calls + error recovery. Extract to shared hook or utility.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:50.242758+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:50.242758+01:00"}
{"id":"ig-9xd","title":"[REFACTOR] Error handling uses string matching for error categorization","description":"Several places match error messages by substring to determine error type: e.g. message.includes('not found') or message.includes('404') in src/routes/patients.ts (line 103), src/routes/doctor.ts. This is fragile. Use custom error classes or error codes instead.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:35.26683+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:35.26683+01:00"}
{"id":"ig-9z9","title":"Notfall-Triage-Logik implementieren","description":"Implementiere die Triage-Logik für zahnärztliche Notfälle basierend auf Feedback von Dirk Säger.\n\n## Echte Notfälle (höchste Priorität - zeitnah behandeln)\n\n### Priorität 1 - Sofort\n1. **Schwellung im Gesicht** (Abszess-Verdacht)\n   - Begleitsymptome: Unwohlsein, Fieber, schlechter Allgemeinzustand\n   - → Gleicher Tag, nächster freier Slot\n\n2. **Nachblutung nach Extraktion**\n   - → Sofort einschieben\n\n3. **Plötzliche starke Schmerzen an einzelnem Zahn**\n   - Verdacht auf retrograde Pulpitis\n   - → Gleicher Tag\n\n### Priorität 2 - Dringend\n4. **Lockerer Zahn durch parodontale Probleme**\n   - Patient kann nicht mehr zubeißen\n   - → Innerhalb 24h\n\n### Priorität 3 - Zeitnah\n5. **Defekte Prothese** (besonders bei älteren Patienten)\n   - Kann von Assistenz angenommen werden\n   - ZA entscheidet in 60s max\n   - → Gleicher/nächster Tag\n\n## Technische Umsetzung\n- Fragebogen zur Symptom-Erfassung\n- Scoring-System für Dringlichkeit\n- Integration mit Voice-Agent für telefonische Triage\n- Automatisches Slot-Finding für Notfälle","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:09.086345+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:43.23186+01:00","closed_at":"2026-02-06T08:51:43.23186+01:00","close_reason":"Notfall-Triage-Logik wird in Mira mit regulatorisch konformem Ansatz (admin. Priorisierung statt klinische Triage) neu konzipiert","dependencies":[{"issue_id":"ig-9z9","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.278769+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-9zi","title":"Standard: Release/Changelog Konvention","description":"Standard fuer Versionierung und Changelog-Pflege.\n\n## Problem\nBei v0.2.0 Release musste ad-hoc entschieden werden: Changelog-Format, Tag-Strategie, wo Version bumpen.\n\n## Standard-Inhalt\n- SemVer Regeln fuer Ignis (wann Major/Minor/Patch)\n- Changelog-Format: Keep a Changelog\n- Version bump in package.json (root + frontend)\n- Git Tags: v{version} annotated tags\n- Release-Checkliste: changelog -\u003e version bump -\u003e commit -\u003e tag -\u003e push --tags -\u003e deploy\n\n## Dateien\n- NEU: .claude/standards/release/changelog.md\n- UPDATE: .claude/standards/index.yml","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:43:50.663906+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T10:58:43.184463+01:00","closed_at":"2026-02-06T10:58:43.184463+01:00","close_reason":"Standard erstellt: release/changelog.md mit SemVer, Keep-a-Changelog Format, Release-Checkliste"}
{"id":"ig-afr","title":"Backend: GET /api/appointments/slots/next - Return next N available slots from now","description":"ElevenLabs has requested a backend route that returns the next available appointment slots from the current point in time, for use when patients ask \"when's the next available appointment?\" during voice calls.\n\n## Requirements\n\n- **Route**: New endpoint (e.g. GET /api/appointments/slots/next or similar)\n- **Behavior**: Search forward from the current date/time and return the next N slots/appointments available for booking by the patient\n- **Scope**: \"From the current point in time\" — the API should not require the caller to specify a date; it searches forward until it has collected enough slots\n\n## Implementation Detail\n\nThe number of slots returned should **not** be fixed at 3. Instead:\n- **Configurable by caller**: The API should accept an optional query parameter (e.g. `limit` or `count`) allowing the caller to request how many slots to return\n- **Default**: When not specified, return 3 slots\n- **Reasonable bounds**: Enforce a sensible min (e.g. 1) and max (e.g. 20) to prevent abuse and keep responses manageable\n\n## Example\n\n```\nGET /api/appointments/slots/next?limit=5\n→ Returns next 5 available slots from today onward\n\nGET /api/appointments/slots/next\n→ Returns next 3 available slots (default)\n```\n\n## Context\n\n- Existing GET /api/appointments/slots requires a `date` parameter and returns slots for that specific date only\n- This new route complements that by providing a \"next available\" view for voice/conversational flows where the patient has not yet specified a date\n- Integrates with ElevenLabs voice agent (get_available_slots / similar tool)\n- May leverage existing FHIR Slot querying and stub slot generation logic in src/routes/appointments.ts","status":"closed","priority":2,"issue_type":"task","owner":"windfox@gmx.de","created_at":"2026-02-01T11:23:02.388216779+01:00","created_by":"alissa","updated_at":"2026-02-01T12:04:23.322304+01:00","closed_at":"2026-02-01T11:28:09.219950027+01:00"}
{"id":"ig-aoz","title":"MFA-Dashboard: Echtzeit-Popup bei erkannten Notfall-Keywords","description":"Während eines laufenden Anrufs zeigt das Praxis-Dashboard ein Popup/Banner wenn die KI Notfall-Keywords erkennt.\n\n**UI-Verhalten:**\n- Popup erscheint im Dashboard (Push via WebSocket/SSE)\n- Zeigt: Patientenname, erkannte Keywords, Patientenhistorie\n- MFA entscheidet: Anruf übernehmen / in Urgent-Queue / ignorieren\n- Popup verschwindet nicht automatisch (muss von MFA bestätigt werden)\n\n**Technisch:**\n- Backend sendet Event via bestehende WebSocket-Infrastruktur\n- Frontend: Modal/Toast-Notification in der Dashboard-UI\n- Kein Live-Transfer in Phase 1 (abhängig von Telefonanlage)\n- Phase 2: Live-Transfer wenn Telefonanlage es unterstützt\n\n**Regulatorisch:**\n- Reine Informationsanzeige, keine automatische Eskalation\n- Default ohne MFA-Aktion: Patient bleibt in normaler Warteschlange\n- Positionierung als 'administrative Benachrichtigung'","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T08:49:56.822573+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:55:09.406378+01:00","closed_at":"2026-02-06T08:55:09.406378+01:00","close_reason":"MFA-Dashboard Feature wird in Mira-Projekt weiterverfolgt. Fuer Ignis wird stattdessen ein regulatorischer Hinweis im README ergaenzt."}
{"id":"ig-ark","title":"implement backend routes according to their definition in docs using the defined tech stack","status":"closed","priority":2,"issue_type":"task","owner":"windfox@gmx.de","created_at":"2026-01-31T16:51:32.347938577+01:00","created_by":"alissa","updated_at":"2026-02-01T10:30:44.564723+01:00","closed_at":"2026-02-01T10:28:38.756694197+01:00"}
{"id":"ig-asv","title":"[REFACTOR] Stub endpoints in patients.ts return empty arrays","description":"src/routes/patients.ts has 3 stub endpoints: GET /:id/encounters (line 115), GET /:id/conditions (line 129), GET /:id/documents (line 148). All return empty arrays. Either implement with real FHIR data or remove and document as not-yet-implemented.","status":"open","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:18.767153+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:18.767153+01:00"}
{"id":"ig-at1","title":"[REFACTOR] normalizePhone() duplicated in aidbox-patients.ts and aidbox-voice.ts","description":"normalizePhone() is duplicated in src/lib/aidbox-patients.ts (line 13) and src/lib/aidbox-voice.ts (line 16). Identical implementations. Extract to shared utility.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:57.232317+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:08.384731+01:00"}
{"id":"ig-b8j","title":"Frontend: PatientCard questionnaire status indicator","description":"Add visual indicator on PatientCard showing if patient has completed intake questionnaire","design":"-","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:29:24.62706+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:14.496888+01:00","closed_at":"2026-02-06T09:21:14.496888+01:00","close_reason":"PatientTable Fragebogen-Spalte mit Status-Badges (Ausgefüllt/In Bearbeitung/Ausstehend) + Modal-Integration, 8 Tests","dependencies":[{"issue_id":"ig-b8j","depends_on_id":"ig-swo","type":"parent-child","created_at":"2026-02-01T10:29:31.999374+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-b8j","depends_on_id":"ig-1nb","type":"blocks","created_at":"2026-02-01T10:29:32.164063+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-b8j","depends_on_id":"ig-0l7","type":"blocks","created_at":"2026-02-06T09:08:28.324058+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-ban","title":"Implement document upload for patients","description":"patient-documents.tsx has upload button placeholder with no implementation. Add POST /api/patients/:id/documents endpoint and implement frontend upload.","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:17.304124+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.324697+01:00","closed_at":"2026-02-06T08:51:29.324697+01:00","close_reason":"Dokument-Upload ist nice-to-have, nicht relevant fuer Ignis-Abschluss"}
{"id":"ig-bhu","title":"[REFACTOR] getPatientById() duplicated in aidbox-patients.ts and aidbox-voice.ts","description":"getPatientById() has identical implementations in src/lib/aidbox-patients.ts (line 136) and src/lib/aidbox-voice.ts (line 108). aidbox-voice.ts should import from aidbox-patients.ts instead.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:00:55.354903+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:05.506319+01:00"}
{"id":"ig-bin","title":"POST /api/auth/elevate - Elevate session to higher authentication level","description":"Elevate existing JWT to higher authentication level by providing additional factors. Returns NEW JWT with higher level.\n\n## Single JWT Design\nThis endpoint takes the current JWT and returns a NEW JWT with elevated level. The frontend should replace the old token with the new one. Only one token is active at a time.\n\n## Request\n```typescript\nPOST /api/auth/elevate\nHeaders: Authorization: Bearer \u003ccurrent-jwt\u003e\n{\n  \"postalCode\": string,  // For Level 3\n  // OR\n  \"streetName\": string   // Alternative for Level 3\n}\n```\n\n## Response\n```typescript\n{\n  \"jwt\": string,       // NEW JWT with elevated level\n  \"level\": 3,          // New level achieved\n  \"expiresAt\": string  // Same expiry as original\n}\n```\n\n## JWT Changes\nThe new JWT contains:\n- Same `sub`, `iat`, `exp` as original\n- Updated `level`: 3\n- New `elevatedAt`: ISO timestamp of elevation\n\n## Implementation Steps\n1. Verify current JWT from Authorization header\n2. Extract patient ID from JWT `sub` claim\n3. Fetch patient from FHIR\n4. Verify provided factor (postalCode or streetName) matches patient record\n5. If match: sign NEW JWT with level=3, same expiry\n6. Return new JWT\n\n## Error Responses\n- 401 `invalid_token`: JWT invalid or expired\n- 401 `invalid_factor`: Postal code/street doesn't match\n- 400 `already_at_level`: Already at requested level or higher\n\n## Level Requirements\n- Level 2 → 3: Requires postalCode OR streetName\n- Level 3 → 4: Cannot elevate directly, must use /auth/request-otp + /auth/confirm-action\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:23:22.091682+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T09:39:59.213227+01:00","closed_at":"2026-02-01T08:25:55.66949652+01:00","dependencies":[{"issue_id":"ig-bin","depends_on_id":"ig-iug","type":"blocks","created_at":"2026-01-31T22:01:27.11344+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-bpu","title":"Setup server environment","description":"Configure the ignis-hackathon server (167.235.236.238):\n- Run setup-remote.sh to configure GitHub access\n- Configure .env with API keys from hackathon perks\n- Start Docker services (Aidbox, n8n)\n- Verify all services running","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T14:52:34.263209+01:00","created_by":"mayor","updated_at":"2026-01-31T16:20:19.579872758+01:00","closed_at":"2026-01-31T16:10:30.019265+01:00"}
{"id":"ig-c0o","title":"Standard: Seed-Daten Konsistenz und Docker-Scripts","description":"Standard fuer Seed-Script-Management und Docker-Image-Inhalte.\n\n## Problem\n1. seed-patients-today.ts und seed-questionnaire-responses.ts muessen manuell in richtiger Reihenfolge ausgefuehrt werden\n2. Dockerfile.api kopiert nur src/, nicht scripts/ - Seeds muessen lokal gegen Remote laufen\n3. Keine Doku welche Seeds in welcher Reihenfolge\n\n## Standard-Inhalt\n- seed-all.ts Wrapper-Script mit Reihenfolge\n- Dokumentation der Seed-Abhaengigkeiten\n- Entscheidung: Scripts ins Docker-Image oder bewusst extern?\n- Idempotenz-Anforderung fuer alle Seeds","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:43:59.500957+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T10:59:57.119146+01:00","closed_at":"2026-02-06T10:59:57.119146+01:00","close_reason":"Standard erstellt: seed-data.md mit Reihenfolge, Idempotenz-Regeln, Docker-Strategie"}
{"id":"ig-c4k","title":"[REFACTOR] API version hardcoded as '0.1.0' but project is at v0.2.0","description":"src/index.ts line 32 returns { status: 'ok', version: '0.1.0' } but the project is at v0.2.0 (per CHANGELOG.md and package.json). Either read from package.json or keep in sync manually.","status":"open","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:37.844518+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:37.844518+01:00"}
{"id":"ig-c7o","title":"Implement requireLevel middleware with elevation hints","description":"Implement the requireLevel middleware that returns elevation hints when authentication level is insufficient.\n\n## Purpose\nWhen a protected endpoint is called with insufficient auth level, return a 403 with detailed instructions for the frontend to elevate. The frontend doesn't need to know which endpoints require which level.\n\n## 403 Response Format\n```typescript\n{\n  \"error\": \"insufficient_level\",\n  \"currentLevel\": 2,\n  \"requiredLevel\": 3,\n  \"elevation\": {\n    \"factors\": [\"postalCode\", \"city\"],\n    \"prompt\": \"Please enter your postal code to continue\",\n    \"promptDe\": \"Bitte geben Sie Ihre Postleitzahl ein\"\n  }\n}\n```\n\n## Implementation\n```typescript\nconst ELEVATION_HINTS: Record\u003cnumber, ElevationHint\u003e = {\n  3: {\n    factors: ['postalCode', 'city'],\n    prompt: 'Please enter your postal code to continue',\n    promptDe: 'Bitte geben Sie Ihre Postleitzahl ein',\n  },\n  4: {\n    factors: ['otp'],\n    prompt: 'We will send a verification code to your phone',\n    promptDe: 'Wir senden einen Bestätigungscode an Ihr Telefon',\n    requiresOtp: true,\n  },\n};\n\nfunction requireLevel(minLevel: number) {\n  return async (c: Context, next: Next) =\u003e {\n    // ... verify JWT ...\n    if (payload.level \u003c minLevel) {\n      return c.json({\n        error: 'insufficient_level',\n        currentLevel: payload.level,\n        requiredLevel: minLevel,\n        elevation: ELEVATION_HINTS[minLevel],\n      }, 403);\n    }\n    // ... continue ...\n  };\n}\n```\n\n## Usage\n```typescript\napp.post('/api/prescriptions', requireLevel(3), handler);\n// Frontend calls this, gets 403 with hints, shows dialog, elevates, retries\n```\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:59:31.220662+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T09:39:59.2137+01:00","closed_at":"2026-02-01T08:26:08.185989292+01:00","dependencies":[{"issue_id":"ig-c7o","depends_on_id":"ig-iug","type":"blocks","created_at":"2026-01-31T22:01:33.322328+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-cdn","title":"Create script to preload 631 Synthea patient bundles into Aidbox","description":"Create a script to download and load 631 synthetic patient bundles from SMART on FHIR into Aidbox.\n\n## Data Source\n- Repository: https://github.com/smart-on-fhir/generated-sample-data\n- Path: R4/SYNTHEA/\n- Format: FHIR R4 transaction bundles (JSON)\n- Count: 631 patient bundles\n- Each bundle contains ~180 resources: Patient, Organization, Practitioner, Encounters, Observations, Conditions, etc.\n\n## Server Info\n- Server: 167.235.236.238 (ignis-hackathon)\n- SSH: hackathon@167.235.236.238\n- Project dir: /opt/ignis\n- Aidbox FHIR endpoint: http://localhost:8080/fhir (internal) or https://ignis.cognovis.de/fhir (external)\n- Auth: admin / ignis2026\n\n## Implementation Steps\n\n### 1. Create infra/load-synthea-data.sh script\nThe script should:\n- Accept optional parameter for number of patients to load (default: all 631)\n- Download patient bundle list from GitHub API\n- Download each bundle to a temp directory\n- POST each bundle to Aidbox FHIR endpoint as transaction\n- Show progress (e.g., 'Loading patient 1/631...')\n- Handle errors gracefully (continue on failure, report at end)\n- Clean up temp files when done\n- Report summary: loaded/failed/skipped\n\n### 2. Script requirements\n\\`\\`\\`bash\n#\\!/bin/bash\n# Usage: ./load-synthea-data.sh [count]\n# count: number of patients to load (default: all)\n#\n# Examples:\n#   ./load-synthea-data.sh        # Load all 631 patients\n#   ./load-synthea-data.sh 50     # Load first 50 patients\n#   ./load-synthea-data.sh 10     # Load first 10 patients (quick test)\n\\`\\`\\`\n\n### 3. Update infra/setup-services.sh\n- Add optional flag to load Synthea data: --with-synthea-data [count]\n- Or add prompt asking if user wants to load demo data\n\n### 4. Transfer and run on server\n\\`\\`\\`bash\n# On local machine\ngit add infra/load-synthea-data.sh\ngit commit -m 'Add Synthea patient data loader script'\ngit push\n\n# On server\nssh hackathon@167.235.236.238\ncd /opt/ignis\ngit pull\nchmod +x infra/load-synthea-data.sh\n./infra/load-synthea-data.sh 50  # Test with 50 first\n./infra/load-synthea-data.sh     # Then load all\n\\`\\`\\`\n\n### 5. Verify loaded data\n\\`\\`\\`bash\n# Check patient count\ncurl -s -u admin:ignis2026 https://ignis.cognovis.de/fhir/Patient | jq '.total'\n\n# Check other resources\ncurl -s -u admin:ignis2026 https://ignis.cognovis.de/fhir/Observation | jq '.total'\ncurl -s -u admin:ignis2026 https://ignis.cognovis.de/fhir/Condition | jq '.total'\ncurl -s -u admin:ignis2026 https://ignis.cognovis.de/fhir/Encounter | jq '.total'\n\\`\\`\\`\n\n## Acceptance Criteria\n- [ ] infra/load-synthea-data.sh script created\n- [ ] Script handles errors gracefully\n- [ ] Script shows progress during loading\n- [ ] Script committed and pushed to repo\n- [ ] Script transferred to server via git pull\n- [ ] Script executed successfully on server\n- [ ] Patient count verified (600+ patients in Aidbox)\n- [ ] Related resources verified (Observations, Conditions, Encounters exist)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T16:46:57.871653+01:00","created_by":"mayor","updated_at":"2026-02-06T08:50:54.168071+01:00","closed_at":"2026-02-06T08:50:54.168071+01:00","close_reason":"Synthea-Daten nicht mehr noetig - bestehende 310+ Testpatienten reichen fuer Ignis-Abschluss."}
{"id":"ig-coa","title":"[REFACTOR] Frontend: priorityConfig and statusConfig duplicated in queue components","description":"Same priorityConfig and statusConfig objects defined in both frontend/app/wartezimmer/page.tsx and frontend/components/dashboard-waiting-queue.tsx. Extract to shared constants file.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:42.376578+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:42.376578+01:00"}
{"id":"ig-cpl","title":"ElevenLabs: Configure add_to_urgent_queue Tool","description":"Configure the add_to_urgent_queue tool for urgent (same-day) appointment requests.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** add_to_urgent_queue\n\n**Description:**\nAdd a patient to the urgent queue for same-day callback. Use this when the patient has an urgent medical need that requires attention today but is NOT an emergency. The practice staff will call back within 30 minutes.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID (or null for new patients)\"\n    },\n    \"phone\": {\n      \"type\": \"string\",\n      \"description\": \"Callback phone number\"\n    },\n    \"reason\": {\n      \"type\": \"string\",\n      \"description\": \"Brief description of the urgent issue\"\n    },\n    \"symptoms\": {\n      \"type\": \"array\",\n      \"items\": { \"type\": \"string\" },\n      \"description\": \"List of symptoms mentioned\"\n    }\n  },\n  \"required\": [\"phone\", \"reason\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/queue/urgent\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"queuePosition\": 3,\n  \"estimatedCallback\": \"30 minutes\"\n}\n```\n\n## Triage Flow\nBefore using this tool, assess urgency:\n- Chest pain, difficulty breathing, severe bleeding → Use register_emergency instead\n- High fever, acute pain, infection symptoms → Use this tool (urgent)\n- Routine questions, prescription refills → Regular appointment\n\n## Voice Response Example\n'Ich habe Sie auf die Dringlichkeitsliste gesetzt. Ein Mitarbeiter wird Sie innerhalb von 30 Minuten unter dieser Nummer zurückrufen. Bei Verschlechterung rufen Sie bitte den Notruf 112 an.'\n\n## Authentication\nRequires Level 1 (birth date verified) for known patients. New patients can be added with just phone number.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:10.056795+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:09.234032+01:00","closed_at":"2026-02-01T12:02:09.234032+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-cpl","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:04.015499+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-dgl","title":"Frontend Refactoring: Move fe_ignis to frontend (Next.js + Bun)","description":"Move fe_ignis/ to frontend/, using Next.js App Router with Bun. See docs/REFACTORING-PLAN.md for full plan. Phases: 1) Move and clean up, 2) Configure Bun + Next.js, 3) Update deployment, 4) Migrate API client, 5) Testing setup.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:58:31.530729+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:38:24.80546+01:00","closed_at":"2026-02-01T11:38:24.80546+01:00","close_reason":"Frontend refactoring completed"}
{"id":"ig-dr1","title":"[REFACTOR] No shared types between backend and frontend - types duplicated","description":"Backend (src/lib/schemas.ts) and frontend (frontend/lib/api.ts) both define their own QueueEntry, FHIRPatient, QueueStatus, Priority types with slightly different shapes. Consider a shared types package or codegen approach to keep them in sync.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:58.311561+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:58.311561+01:00"}
{"id":"ig-drf","title":"Doctor dashboard: View prefilled intake questionnaires","description":"Create a doctor-facing dashboard to view prefilled patient intake forms.\n\n## Context\nPatients complete intake questionnaires via the AI voice agent before their appointment. Doctors need to review this information before seeing the patient.\n\n## Features\n1. List view of upcoming appointments with intake status\n2. Detail view showing completed QuestionnaireResponse data\n3. Display patient-reported symptoms, medical history, reason for visit\n4. Filter by date/practitioner/completion status\n\n## Technical Implementation\n- Frontend: React component in doctor dashboard\n- Backend: GET /api/doctor/patients/:patientId/intake-forms\n- FHIR: Query QuestionnaireResponse by patient + encounter/appointment\n\n## Related\n- ig-drp: Prescription form requests (companion feature)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T21:30:00+01:00","created_by":"alissa","updated_at":"2026-02-06T08:51:43.31296+01:00","closed_at":"2026-02-06T08:51:43.31296+01:00","close_reason":"Doctor dashboard Questionnaires ist nice-to-have, Kern-Dashboard funktioniert"}
{"id":"ig-drp","title":"Doctor dashboard: View and manage prescription form requests","description":"Enable doctors to view and act on prescription requests collected during patient intake.\n\n## Context\nDuring AI voice intake, patients may request prescription refills or new prescriptions. These requests need to be surfaced to doctors for review and action.\n\n## Features\n1. List of pending prescription requests\n2. Patient details and medication history context\n3. Approve/deny/modify workflow\n4. Integration with e-prescription system (future)\n\n## Technical Implementation\n- Frontend: Prescription queue component in doctor dashboard\n- Backend: GET /api/doctor/prescription-requests, POST /api/doctor/prescription-requests/:id/action\n- FHIR: MedicationRequest resources with status tracking\n\n## Related\n- ig-drf: Intake questionnaire viewing (companion feature)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T21:30:00+01:00","created_by":"alissa","updated_at":"2026-02-06T08:51:43.398389+01:00","closed_at":"2026-02-06T08:51:43.398389+01:00","close_reason":"Doctor dashboard Prescriptions ist nice-to-have, Kern-Dashboard funktioniert"}
{"id":"ig-dsi","title":"Add team SSH keys","description":"Collect and add SSH keys for all team members to server.\nServer: hackathon@167.235.236.238\n\nAdded:\n- Malte (provisioner key)\n- Sven (ecdsa-sha2-nistp256)\n\nTo add:\n- Other team members","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T14:52:42.205331+01:00","created_by":"mayor","updated_at":"2026-02-06T08:49:35.842522+01:00","closed_at":"2026-02-06T08:49:35.842522+01:00","close_reason":"Hackathon abgeschlossen, Server-Zugang nicht mehr relevant für aktive Entwicklung."}
{"id":"ig-e0z","title":"Initialize Bun + Hono backend and Vite React frontend","description":"Initialize the full development stack as per PLAN.md:\n\n## Backend (root)\n- Bun runtime\n- Hono framework with Zod validation\n- Dependencies: hono, @hono/zod-validator, zod, @google/generative-ai, axios, date-fns\n- Entry point: src/index.ts\n\n## Frontend (frontend/)\n- Vite + React + TypeScript\n- Tailwind CSS v4\n- shadcn/ui components (button, card, input, form, calendar, label)\n- Dependencies: react-router-dom, react-hook-form, @tanstack/react-query\n- Path alias: @/* -\u003e src/*\n\n## Verification\n- Backend runs on port 3000: bun run dev\n- Frontend runs on port 5173: cd frontend \u0026\u0026 bun run dev\n- Frontend proxies /api to backend","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T16:44:38.088124+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-01-31T16:44:46.980179+01:00","closed_at":"2026-01-31T16:44:46.980179+01:00","close_reason":"Closed"}
{"id":"ig-e16","title":"[REFACTOR] Frontend: transformQueueEntry duplicated in wartezimmer and dashboard-waiting-queue","description":"Nearly identical transformQueueEntry() functions in: frontend/app/wartezimmer/page.tsx (lines 53-91) and frontend/components/dashboard-waiting-queue.tsx (lines 37-73). Extract to shared utility e.g. frontend/lib/queue-utils.ts.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:40.567157+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:40.567157+01:00"}
{"id":"ig-e4h","title":"Feature: Chat Interface with Voice Switching for Patient Portal Demo","design":"-","status":"closed","priority":2,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:31.453557+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:16:16.951735+01:00","closed_at":"2026-02-01T12:16:16.951735+01:00","close_reason":"All child tasks complete: chat UI, API integration, voice mode, and FHIR storage"}
{"id":"ig-eca","title":"ElevenLabs: Configure get_available_slots Tool","description":"Configure the get_available_slots tool to find appointment availability.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** get_available_slots\n\n**Description:**\nGet available appointment slots for a given date or date range. Use this when the patient wants to book an appointment and needs to know available times.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"date\": {\n      \"type\": \"string\",\n      \"description\": \"Date to check (YYYY-MM-DD format)\"\n    },\n    \"urgency\": {\n      \"type\": \"string\",\n      \"enum\": [\"regular\", \"urgent\", \"same-day\"],\n      \"description\": \"Urgency level affects slot availability\"\n    },\n    \"limit\": {\n      \"type\": \"integer\",\n      \"description\": \"Maximum number of slots to return (default: 5)\"\n    }\n  },\n  \"required\": [\"date\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/appointments/slots?date=${date}\u0026urgency=${urgency}\u0026limit=${limit}\n- Method: GET\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n\n## Expected Response\n```json\n{\n  \"slots\": [\n    {\n      \"id\": \"slot-001\",\n      \"date\": \"2026-02-15\",\n      \"time\": \"09:00\",\n      \"practitioner\": \"Dr. Müller\",\n      \"available\": true\n    },\n    {\n      \"id\": \"slot-002\",\n      \"date\": \"2026-02-15\",\n      \"time\": \"10:30\",\n      \"practitioner\": \"Dr. Müller\",\n      \"available\": true\n    }\n  ]\n}\n```\n\n## Voice Flow\n1. Patient: 'Ich möchte einen Termin'\n2. Agent: 'Für welchen Tag suchen Sie einen Termin?'\n3. Patient: 'Nächste Woche Dienstag'\n4. Agent: Calls get_available_slots with date\n5. Agent: 'Am Dienstag haben wir um 9 Uhr und 10:30 Uhr freie Termine. Welche Zeit passt Ihnen besser?'\n\n## Authentication\nNo authentication required to view available slots (public info).","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:40.875659+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:27.719572+01:00","closed_at":"2026-02-01T12:02:27.719572+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-eca","depends_on_id":"ig-zoz","type":"blocks","created_at":"2026-01-31T22:01:04.33989+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-egg","title":"Standard: Frontend View Impact Check","description":"Standard anlegen der bei UI-Features automatisch alle betroffenen Views identifiziert.\n\n## Problem\nBei ig-b8j wurden Fragebogen-Status-Badges nur in patient-table.tsx eingebaut, aber wartezimmer/dashboard/termine vergessen. Das musste manuell nachgeholt werden (ig-pvu).\n\n## Standard-Inhalt\n- Bei neuen UI-Elementen: grep/suche nach dem Datentyp in allen Views\n- Checkliste: Welche Views zeigen Patienten/Queue/Termine?\n- Regel: Ab 2 Views -\u003e eigene Komponente von Anfang an\n- In Bead-Description aufnehmen: 'Betroffene Views: ...'\n\n## Dateien\n- NEU: .claude/standards/frontend/view-impact-check.md\n- UPDATE: .claude/standards/index.yml (neuer Trigger)","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:43:46.177988+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T10:58:31.059159+01:00","closed_at":"2026-02-06T10:58:31.059159+01:00","close_reason":"Standard erstellt: frontend/view-impact-check.md + index.yml Trigger"}
{"id":"ig-el1","title":"ElevenLabs: Claim hackathon perk","description":"Claim ElevenLabs 3-month Creator plan from hackathon sponsors.\n\n## Status: COMPLETED\n- API key obtained: sk_634...a2\n- Added to .env on server\n\n## Steps Completed\n1. Go to hackathon sponsor page\n2. Claim 3 months Creator plan\n3. Generate API key\n4. Add ELEVENLABS_API_KEY to .env","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-01-31T17:00:00+01:00","closed_at":"2026-01-31T17:00:00+01:00"}
{"id":"ig-el2","title":"ElevenLabs: Select voice","description":"Select multilingual voice for patient intake agent.\n\n## Status: COMPLETED\n- Selected: Leonie (female, warm, multilingual)\n- Supports both German and English\n\n## Voice Requirements\n- Empathetic and caring tone\n- Clear pronunciation for medical terms\n- Natural-sounding in both DE and EN","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-01-31T17:00:00+01:00","closed_at":"2026-01-31T17:00:00+01:00","dependencies":[{"issue_id":"ig-el2","depends_on_id":"ig-el1","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"}]}
{"id":"ig-el3","title":"ElevenLabs: Create agent","description":"Create Conversational AI agent in ElevenLabs dashboard.\n\n## Status: COMPLETED\n- Agent name: Ignis Demo Praxis\n- Language detection: Enabled\n- Voice: Leonie\n\n## Configuration\n- Enabled automatic language detection (System Tool)\n- Configured for German (primary) + English\n- Audio format compatible with web interface","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-01-31T17:00:00+01:00","closed_at":"2026-01-31T17:00:00+01:00","dependencies":[{"issue_id":"ig-el3","depends_on_id":"ig-el2","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"}]}
{"id":"ig-el4","title":"ElevenLabs: Configure system prompt","description":"Write and configure bilingual system prompt for patient intake.\n\n## Status: COMPLETED\n- System prompt pasted into ElevenLabs agent\n- Includes 3-tier triage (Emergency/Urgent/Regular)\n- Emergency detection with DE+EN keywords\n- Guardrails: never give medical advice, always transfer emergencies to human\n\n## Key Features\n- Bilingual (German + English)\n- Patient lookup and identification\n- Appointment booking flow\n- Emergency keyword detection (Herzinfarkt, chest pain, etc.)\n- Empathetic conversation style","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-01-31T17:00:00+01:00","closed_at":"2026-01-31T17:00:00+01:00","dependencies":[{"issue_id":"ig-el4","depends_on_id":"ig-el3","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"}]}
{"id":"ig-el5","title":"ElevenLabs: Configure tools in dashboard","description":"Add 6 custom tools to ElevenLabs agent matching OpenAPI spec.\n\n## Prerequisites\n- ig-el6: Backend endpoints must be deployed first\n- Base URL: https://ignis.cognovis.de/api\n\n## Tools to Configure\n\n### 1. patient_lookup (GET /api/patients/lookup)\nFind returning patient by phone/DOB\n\n### 2. patient_create_or_update (POST /api/patients)\nCreate or update patient record\n\n### 3. get_available_slots (GET /api/appointments/slots)\nGet bookable appointment slots for a date\n\n### 4. book_appointment (POST /api/appointments)\nBook appointment for chosen slot\n\n### 5. add_to_urgent_queue (POST /api/queue/urgent)\nAdd to urgent callback queue\n\n### 6. register_emergency_transfer (POST /api/queue/emergency)\nLog emergency before human transfer\n\n## Reference\nSee docs/backend-services-elevenlabs.openapi.yaml for full spec","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-02-01T12:02:09.169943+01:00","closed_at":"2026-02-01T12:02:09.169943+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-el5","depends_on_id":"ig-el6","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"},{"issue_id":"ig-el5","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:43.796352+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el5","depends_on_id":"ig-f4d","type":"blocks","created_at":"2026-01-31T22:01:43.879939+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el5","depends_on_id":"ig-2ch","type":"blocks","created_at":"2026-01-31T22:01:43.955411+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-el6","title":"ElevenLabs: Implement backend endpoints","description":"Implement 6 API endpoints in Bun+Hono backend for ElevenLabs tools.\n\n## Prerequisites\n- ig-mbl: OpenAPI spec defined (DONE)\n- Aidbox FHIR server running at https://ignis.cognovis.de/fhir\n\n## Endpoints to Implement\n\n### 1. GET /api/patients/lookup\n- Query params: phone, birthDate\n- FHIR: Search Patient by telecom/birthdate\n- Return: { found: boolean, patient: FHIR Patient or null }\n\n### 2. POST /api/patients\n- Body: family, given, birthDate, phone, email?, gender?\n- FHIR: POST/PUT Patient\n- Return: { patient: FHIR Patient, created: boolean }\n\n### 3. GET /api/appointments/slots\n- Query params: date, practitionerId?, limit?\n- FHIR: Query Slot/Schedule\n- Return: { slots: [{ slotId, start, end, practitionerDisplay }] }\n\n### 4. POST /api/appointments\n- Body: slotId, patientId, type?, reason?\n- FHIR: POST Appointment, update Slot\n- Return: { appointment, start, end, confirmationMessage? }\n\n### 5. POST /api/queue/urgent\n- Body: patientId, reason?, phone?\n- FHIR: Create Task/List entry\n- Return: { queueEntryId, position?, message? }\n\n### 6. POST /api/queue/emergency\n- Body: patientId?, phone?, reason?\n- FHIR: Create Task for emergency transfer\n- Return: { transferId, message? }\n\n## Files to Create\n- src/routes/patients.ts\n- src/routes/appointments.ts\n- src/routes/queue.ts\n- src/lib/aidbox-client.ts\n\n## Reference\nSee docs/backend-services-elevenlabs.openapi.yaml","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-02-01T11:46:31.135797+01:00","closed_at":"2026-02-01T11:46:31.135797+01:00","close_reason":"All 6 endpoints already implemented: patients lookup/create, appointments slots/book, queue urgent/emergency","dependencies":[{"issue_id":"ig-el6","depends_on_id":"ig-mbl","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"},{"issue_id":"ig-el6","depends_on_id":"ig-6xd","type":"blocks","created_at":"2026-01-31T22:01:43.560572+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el6","depends_on_id":"ig-foa","type":"blocks","created_at":"2026-01-31T22:01:43.642636+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el6","depends_on_id":"ig-0fo","type":"blocks","created_at":"2026-01-31T22:01:43.723157+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-el7","title":"ElevenLabs: Test full flow","description":"End-to-end test of ElevenLabs agent with all tools connected.\n\n## Prerequisites\n- ig-el5: Tools configured in ElevenLabs dashboard\n- Backend deployed and accessible\n\n## Test Scenarios\n\n### 1. Returning Patient - Regular Booking (English)\n- Call agent, provide name + DOB\n- Verify patient_lookup finds existing patient\n- Request flu shot appointment\n- Verify get_available_slots returns times\n- Choose a slot\n- Verify book_appointment creates FHIR Appointment\n- Confirm appointment details\n\n### 2. New Patient - Regular Booking (German)\n- Call agent in German\n- Provide new patient details\n- Verify patient_create_or_update creates new Patient\n- Book appointment\n- Confirm in German\n\n### 3. Emergency Detection\n- Start regular conversation\n- Mid-call mention 'Brustschmerzen' or 'chest pain'\n- Verify agent immediately calls register_emergency_transfer\n- Verify agent attempts human transfer\n\n### 4. Urgent Case - No Slots\n- Report post-surgery bleeding\n- Verify triage as urgent\n- If no same-day slots, verify add_to_urgent_queue called\n\n## Verification\n- Check Aidbox for created Patient/Appointment resources\n- Check dashboard for urgent queue entries\n- Check emergency transfer logs","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor","updated_at":"2026-02-06T08:59:05.506547+01:00","closed_at":"2026-02-06T08:59:05.506547+01:00","close_reason":"4 Testszenarien wurden von Alissa/Nevi durchgespielt. Ausfuehrlicherer Testplan als mira-80n in Mira angelegt.","dependencies":[{"issue_id":"ig-el7","depends_on_id":"ig-el5","type":"blocks","created_at":"2026-01-31T17:00:00+01:00","created_by":"cursor"},{"issue_id":"ig-el7","depends_on_id":"ig-ru4","type":"blocks","created_at":"2026-01-31T22:01:16.596403+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el7","depends_on_id":"ig-nrx","type":"blocks","created_at":"2026-01-31T22:01:16.679423+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el7","depends_on_id":"ig-7gv","type":"blocks","created_at":"2026-01-31T22:01:16.761442+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el7","depends_on_id":"ig-f4d","type":"blocks","created_at":"2026-01-31T22:01:16.836749+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-el7","depends_on_id":"ig-2ch","type":"blocks","created_at":"2026-01-31T22:01:16.913585+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-ell","title":"[GLOBAL] /refactor-note Command","description":"Command das schnell ein Refactoring-Bead anlegt wenn man waehrend der Arbeit Code-Smells entdeckt.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/commands/refactor-note.md\n\n## Status\nBereits in CLAUDE.md als Pattern referenziert (bd create --title='[REFACTOR] ...' --type=task --priority=3).\nCommand formalisiert das als Slash-Command.\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/commands/refactor-note.md\n- 1:1 uebertragbar, nutzt nur bd create\n- Stack-agnostisch\n\n## Acceptance Criteria\n- [ ] Command in globalem Claude-Config-Repo\n- [ ] Erstellt Bead mit [REFACTOR] Prefix, type=task, priority=3","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:34.807292+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:28.604205+01:00"}
{"id":"ig-f07","title":"Add reschedule endpoint for appointment time/date changes","description":"Backend: Add PATCH /api/appointments/:id/reschedule endpoint to update appointment start/end times in FHIR. Current backend only has status updates.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:10.170708+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:25:28.446113+01:00","closed_at":"2026-02-01T12:25:28.446113+01:00","close_reason":"SSE endpoint and reschedule endpoint implemented and tested"}
{"id":"ig-f1z","title":"Emergency Detection - Always-on interrupt during calls","description":"Implement safety-critical always-on emergency detection that can interrupt conversation at any point. Features: continuous monitoring for emergency keywords (German/English), immediate interrupt capability, human agent transfer workflow, emergency alert UI in dashboard. Emergency keywords: Herzinfarkt, Brustschmerzen, Atemnot, Blutung, Ohnmacht, Schlaganfall, etc.","status":"closed","priority":1,"issue_type":"feature","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:24.795451+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:53:14.115948+01:00","closed_at":"2026-02-06T08:53:14.115948+01:00","close_reason":"Emergency Keywords im System Prompt v2.1 implementiert, Interrupt-Logik in ElevenLabs aktiv. Dashboard-Alert wird neu in ig-aoz getrackt."}
{"id":"ig-f3v","title":"add RAG document to ElevenLabs (e.g., how to get to the MVZ)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T20:40:47.088544028+01:00","created_by":"alissa","updated_at":"2026-02-06T08:55:09.575057+01:00","closed_at":"2026-02-06T08:55:09.575057+01:00","close_reason":"RAG-Dokument fuer ElevenLabs ist nice-to-have, nicht noetig fuer Ignis-Abschluss."}
{"id":"ig-f4d","title":"ElevenLabs: Configure authenticate_patient Tool","description":"Configure the authenticate_patient tool in ElevenLabs to verify patient identity.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** authenticate_patient\n\n**Description:**\nVerify a patient's identity using knowledge factors. Call this after collecting verification information from the patient (date of birth, postal code, etc.). The response tells you the achieved authentication level.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID returned from identify_patient\"\n    },\n    \"birth_date\": {\n      \"type\": \"string\",\n      \"description\": \"Patient's date of birth in YYYY-MM-DD format\"\n    },\n    \"postal_code\": {\n      \"type\": \"string\",\n      \"description\": \"Patient's postal code (for Level 2 authentication)\"\n    },\n    \"street_name\": {\n      \"type\": \"string\",\n      \"description\": \"Patient's street name without house number (for Level 3 authentication)\"\n    }\n  },\n  \"required\": [\"patient_id\", \"birth_date\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/voice/authenticate\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n5. Save the tool\n\n## Expected Response Format\n```json\n{\n  \"authenticated\": true,\n  \"level\": 2,\n  \"failedFactor\": null\n}\n```\n\nOr on failure:\n```json\n{\n  \"authenticated\": false,\n  \"level\": 0,\n  \"failedFactor\": \"birthDate\"\n}\n```\n\n## Verification\n- Tool appears in agent's tool list\n- Test with valid patient data returns authenticated: true\n\n## Dependencies\nRequires: POST /api/voice/authenticate endpoint (ig-foa) to be implemented","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:27:58.573912+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:57:18.02977+01:00","closed_at":"2026-02-01T11:57:18.02977+01:00","close_reason":"Verified via ElevenLabs API - agent fully configured with system prompt, 9 tools, and Twilio phone integration","dependencies":[{"issue_id":"ig-f4d","depends_on_id":"ig-zoz","type":"blocks","created_at":"2026-01-31T22:00:50.333322+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-f4d","depends_on_id":"ig-foa","type":"blocks","created_at":"2026-01-31T22:00:55.602736+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-foa","title":"POST /api/voice/authenticate - Verify knowledge factors for voice auth","description":"Verify patient knowledge factors (birth date, postal code, street) for Voice AI authentication. Stateless - each call validates factors against patient record.\n\nInput: { \n  patientId: string,\n  factors: {\n    birthDate?: string,      // Level 1+\n    postalCode?: string,     // Level 2+\n    city?: string,           // Level 2+ (alternative)\n    streetName?: string      // Level 3+\n  }\n}\nOutput: { \n  authenticated: boolean, \n  level: 0 | 1 | 2 | 3,\n  failedFactor?: string \n}\n\nImplementation:\n1. Fetch patient from FHIR by ID\n2. Validate each provided factor against patient record\n3. Calculate highest achieved auth level\n4. Track failed attempts (max 3, then block)\n5. Log attempt (GDPR-compliant, no PII on failure)\n\nSee docs/AUTHENTICATION-POLICY.md for factor matching rules.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:24:45.264463+01:00","created_by":"Malte Sussdorff","updated_at":"2026-01-31T22:16:31.998567+01:00","closed_at":"2026-01-31T22:16:31.998567+01:00","close_reason":"Implemented by parallel subagents"}
{"id":"ig-gi4","title":"Add SSE endpoint for real-time appointment broadcasts","description":"Backend: Create /api/appointments/events SSE endpoint that broadcasts when appointments change (create/update/move/cancel). All connected clients receive updates.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:08.660226+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:25:28.429701+01:00","closed_at":"2026-02-01T12:25:28.429701+01:00","close_reason":"SSE endpoint and reschedule endpoint implemented and tested"}
{"id":"ig-gme","title":"[REFACTOR] Frontend: 5 unused font imports in layout.tsx","description":"frontend/app/layout.tsx imports 5 fonts that are assigned to underscore-prefixed variables (unused): _montserrat, _geistMono, _notoSerif, _firaSans, _firaMono. Remove unused imports to reduce bundle size.","status":"open","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:52.484666+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:52.484666+01:00"}
{"id":"ig-gu1","title":"Save questionnaire responses to FHIR","description":"Backend: Add POST /api/questionnaire-responses endpoint to save QuestionnaireResponse to FHIR. Frontend: fragebogen/page.tsx should submit responses after completion instead of discarding them.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:14.680342+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:14.40988+01:00","closed_at":"2026-02-06T09:21:14.40988+01:00","close_reason":"Frontend Submit an /api/questionnaires/responses + 9 Vitest Tests, convertResponsesToFHIRItems()"}
{"id":"ig-gya","title":"Initialize Bun + Hono backend and Vite React frontend","description":"Initialize the full development stack as per PLAN.md:\n\n## Backend (root)\n- Bun runtime\n- Hono framework with Zod validation\n- Dependencies: hono, @hono/zod-validator, zod, @google/generative-ai, axios, date-fns\n- Entry point: src/index.ts\n\n## Frontend (frontend/)\n- Vite + React + TypeScript\n- Tailwind CSS v4\n- shadcn/ui components (button, card, input, form, calendar, label)\n- Dependencies: react-router-dom, react-hook-form, @tanstack/react-query\n- Path alias: @/* -\u003e src/*\n\n## Verification\n- Backend runs on port 3000: bun run dev\n- Frontend runs on port 5173: cd frontend \u0026\u0026 bun run dev\n- Frontend proxies /api to backend","status":"closed","priority":1,"issue_type":"task","owner":"sven@sven-s.de","created_at":"2026-01-31T16:41:41.515806+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-01-31T16:41:50.506267+01:00","closed_at":"2026-01-31T16:41:50.506267+01:00","close_reason":"Closed"}
{"id":"ig-hcf","title":"Frontend: Chat API Integration","description":"Connect chat UI to backend endpoints and handle message streaming","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:55.832963+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:47:00.61843+01:00","closed_at":"2026-02-01T11:47:00.61843+01:00","close_reason":"Closed","dependencies":[{"issue_id":"ig-hcf","depends_on_id":"ig-e4h","type":"parent-child","created_at":"2026-02-01T10:25:01.733464+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-hcf","depends_on_id":"ig-p8y","type":"blocks","created_at":"2026-02-01T10:25:07.36683+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-hcf","depends_on_id":"ig-3u7","type":"blocks","created_at":"2026-02-01T10:25:07.447197+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-hcf","depends_on_id":"ig-dgl","type":"blocks","created_at":"2026-02-01T10:58:36.342816+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-i1u","title":"Patient Verification Portal - Token-based secure access","description":"Build secure token-based patient verification portal where patients can review and correct AI-collected data after intake call. Features: secure token generation, SMS/email link delivery, editable form with AI-flagged fields highlighted, time-limited access (24-48h)","status":"closed","priority":1,"issue_type":"feature","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:19.933161+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:49:33.843627+01:00","closed_at":"2026-02-06T08:49:33.843627+01:00","close_reason":"Verification Portal nicht mehr nötig - MFA prüft Daten direkt im Dashboard statt Patient über externen Link."}
{"id":"ig-igs","title":"Smart Glass Integration Konzept","description":"Konzept für Smart Glass Integration in Zahnarztpraxis-Workflow.\n\n## Vision (von Malte/Dirk)\n- Beim Raumwechsel: kurze Displays auf Smart Glass\n- Voice-Informationen über nächsten Patienten per Knopfdruck\n- Hands-free Interaktion während Behandlung\n\n## Use Cases\n\n### Raum-zu-Raum Navigation\n- Nächster Patient: Name, Behandlung, Besonderheiten\n- Allergien/Warnhinweise prominent\n- Vorherige Behandlungen kurz zusammengefasst\n\n### Während Behandlung\n- Voice-Notizen diktieren\n- Schnelle Dokumentation\n- Assistenz-Anforderung\n\n### Einschränkungen\n- Lupenbrille-Träger können keine Smart Glass nutzen\n- Alterskorrektur für Nähe problematisch\n- → Primär für jüngere Behandler\n\n## Hardware-Optionen\n- Meta Ray-Ban (Consumer)\n- Vuzix (Medical-Grade)\n- Custom-Lösung mit Raspberry Pi?\n\n## Status\n- Backlog für Post-Hackathon\n- Erst Voice-Agent stabilisieren","status":"closed","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:41.670964+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:19.135339+01:00","closed_at":"2026-02-06T08:51:19.135341+01:00","dependencies":[{"issue_id":"ig-igs","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.663003+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-iug","title":"POST /api/auth/verify-token - Verify magic link token or SMS OTP with birth date","description":"Verify magic link token or SMS OTP combined with birth date. Issues initial Level 2 JWT.\n\n## Single JWT Design\nThis endpoint issues the initial JWT. The same JWT can later be elevated to higher levels via /auth/elevate - no need for multiple tokens.\n\n## Request\n```typescript\nPOST /api/auth/verify-token\n{\n  \"token\": string,      // From magic link URL or SMS\n  \"birthDate\": string   // YYYY-MM-DD format\n}\n```\n\n## Response\n```typescript\n{\n  \"jwt\": string,           // Level 2 JWT (24h expiry)\n  \"level\": 2,\n  \"expiresAt\": string,     // ISO timestamp\n  \"patient\": {\n    \"id\": string,\n    \"name\": string\n  }\n}\n```\n\n## JWT Payload Structure\n```typescript\n{\n  \"sub\": \"patient-2\",       // Patient ID\n  \"iat\": 1706745600,         // Issued at\n  \"exp\": 1706832000,         // Expires (24h)\n  \"level\": 2,                // Auth level\n  \"method\": \"magic_link\"    // How they authenticated\n}\n```\n\n## Implementation Steps\n1. Lookup token hash in database\n2. Check not expired and not used\n3. Get associated patient from FHIR\n4. Verify birth date matches Patient.birthDate\n5. Mark token as used (single-use)\n6. Sign JWT with level=2, 24h expiry\n7. Return JWT + patient info\n\n## Error Responses\n- 401 `invalid_token`: Token not found, expired, or already used\n- 401 `invalid_birthdate`: Birth date doesn't match (max 5 attempts)\n\n## Security\n- Max 5 birth date attempts per token, then token invalidated\n- Token is single-use\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:23:21.111334+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T09:39:59.21416+01:00","closed_at":"2026-02-01T08:25:43.445247481+01:00","dependencies":[{"issue_id":"ig-iug","depends_on_id":"ig-3ln","type":"blocks","created_at":"2026-01-31T22:01:27.025797+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-jls","title":"Notfall-Einschub-Algorithmus","description":"Algorithmus zum intelligenten Einschieben von Notfällen in den Terminplan.\n\n## Anforderungen\n\n### Slot-Finding für Notfälle\n1. Prüfe freie Slots am gleichen Tag\n2. Wenn kein freier Slot:\n   - Identifiziere flexible Termine (Füllungen, 01-Termine)\n   - Prüfe ob Abkürzung möglich\n   - Prüfe ob Verschiebung möglich\n3. Prüfe Pausenzeit-Ausweichen (falls erlaubt)\n\n### Constraints beachten\n- Lange OPs (Implantate, Sinuslift) NICHT unterbrechen\n- Zwischen 01/Zst-Terminen ist natürlicher Puffer\n- Füllungen können abgekürzt werden\n- Notfall-Dauer abschätzen basierend auf Triage\n\n### Workflow für Prothesen-Notfälle\n- Assistenz nimmt Prothese an\n- Zeigt dem ZA kurz (60s max für Entscheidung)\n- Wenn reparierbar: Slot für Reparatur finden\n- Wenn Labor nötig: Termin für später\n\n## Output\n- Vorgeschlagene Slots mit Begründung\n- Betroffene Termine bei Verschiebung\n- Benachrichtigung an betroffene Patienten","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:28.595957+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:47.5834+01:00","closed_at":"2026-02-06T08:51:47.5834+01:00","close_reason":"Notfall-Einschub-Algorithmus wird in Mira neu konzipiert","dependencies":[{"issue_id":"ig-jls","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.516778+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-jls","depends_on_id":"ig-40h","type":"blocks","created_at":"2026-02-01T08:04:48.454177+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-jls","depends_on_id":"ig-9z9","type":"blocks","created_at":"2026-02-01T08:04:48.539432+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-jls","depends_on_id":"ig-6kr","type":"blocks","created_at":"2026-02-01T08:04:48.620177+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-jxt","title":"Frontend: QuestionnaireResponseModal component","description":"Create modal component to display questionnaire responses when clicking on a patient","design":"-","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:29:25.35473+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:14.573605+01:00","closed_at":"2026-02-06T09:21:14.573605+01:00","close_reason":"QuestionnaireResponseModal mit Sections-Gruppierung, FHIR-Answer-Rendering, 12 Tests","dependencies":[{"issue_id":"ig-jxt","depends_on_id":"ig-swo","type":"parent-child","created_at":"2026-02-01T10:29:32.0813+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-jxt","depends_on_id":"ig-1nb","type":"blocks","created_at":"2026-02-01T10:29:32.239708+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-l6x","title":"Replace appointments Zustand mock store with API + SSE","description":"Frontend: Replace useAppointmentsStore (hardcoded mock data) with real API calls to /api/appointments/today. Subscribe to SSE for real-time updates. moveAppointment() should call backend reschedule endpoint.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:11.934093+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:26:42.904789+01:00","closed_at":"2026-02-01T12:26:42.904789+01:00","close_reason":"Implemented SSE real-time sync and API integration for appointments calendar","dependencies":[{"issue_id":"ig-l6x","depends_on_id":"ig-gi4","type":"blocks","created_at":"2026-02-01T12:17:23.02334+01:00","created_by":"Malte Sussdorff"},{"issue_id":"ig-l6x","depends_on_id":"ig-f07","type":"blocks","created_at":"2026-02-01T12:17:23.107852+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-l7l","title":"[GLOBAL] DoD-Reminder Hook (vor bd close)","description":"PreToolUse Hook der vor git commit / bd close an die Definition of Done erinnert.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/hooks/dod-reminder.md\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/hooks/dod-reminder.md\n- Mechanismus ist stack-agnostisch: Vor Commit an DoD erinnern\n- Konkrete Checks (welche Tests, welcher Linter) kommen aus dem jeweiligen Projekt-CLAUDE.md\n- Hook soll generisch fragen: 'Hast du Tests, Linting, Type-Checking, Docs geprueft?'\n- NICHT stack-spezifische Commands hardcoden\n\n## Acceptance Criteria\n- [ ] Hook in globalem Claude-Config-Repo erstellt\n- [ ] Funktioniert projekt-uebergreifend (Python, TypeScript, Swift)\n- [ ] Triggert bei git commit und bd close","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:31.152846+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:02.505583+01:00"}
{"id":"ig-lwx","title":"[IGNIS] Conventional Commits Scopes definieren","description":"Ignis-spezifische Scopes fuer Conventional Commits definieren als Projekt-Override.\n\n## Kontext\nGlobaler Standard git/conventional-commits.md existiert bereits.\nIgnis braucht nur projekt-spezifische Scopes.\n\n## Scopes fuer Ignis\n- api: Backend-API (src/routes/)\n- ui: Frontend-Komponenten (frontend/components/)\n- fhir: FHIR-Client/Library (src/lib/)\n- queue: Warteschlange/Encounters\n- auth: Authentifizierung\n- voice: Voice AI / Twilio\n- beads: Bead/Issue-Tracking Aenderungen\n- release: Version bumps, tags\n\n## Umsetzung\nIn Ignis CLAUDE.md oder als .claude/standards/ignis/commit-scopes.md\n\n## Acceptance Criteria\n- [ ] Scopes dokumentiert und im Projekt auffindbar","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:28.770256+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:42.089652+01:00"}
{"id":"ig-m0x","title":"ElevenLabs: Configure cancel_appointment Tool","description":"Configure the cancel_appointment tool to cancel appointments via voice.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** cancel_appointment\n\n**Description:**\nCancel a patient's existing appointment. Use this when the patient wants to cancel. Always confirm before cancelling as this action cannot be undone. Requires Level 2 authentication.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID from identify_patient\"\n    },\n    \"appointment_id\": {\n      \"type\": \"string\",\n      \"description\": \"The appointment ID to cancel\"\n    },\n    \"auth_level\": {\n      \"type\": \"integer\",\n      \"description\": \"Current authentication level (must be \u003e= 2)\"\n    },\n    \"reason\": {\n      \"type\": \"string\",\n      \"description\": \"Reason for cancellation (optional)\"\n    }\n  },\n  \"required\": [\"patient_id\", \"appointment_id\", \"auth_level\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/appointments/cancel/${appointment_id}\n- Method: POST\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"message\": \"Appointment cancelled\"\n}\n```\n\n## Voice Flow\n1. Patient: 'Ich möchte meinen Termin absagen'\n2. Agent: Fetch appointments, confirm which one\n3. Agent: 'Möchten Sie den Termin am 15. Februar um 10 Uhr wirklich absagen?'\n4. Patient: 'Ja'\n5. Agent: Call cancel_appointment\n6. Agent: 'Ihr Termin wurde abgesagt. Möchten Sie einen neuen Termin vereinbaren?'\n\n## Authentication\nRequires Level 2 (birth date + postal code verified).","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:01.759271+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:02:09.217668+01:00","closed_at":"2026-02-01T12:02:09.217668+01:00","close_reason":"Verified via ElevenLabs API - tools configured and pointing to correct endpoints","dependencies":[{"issue_id":"ig-m0x","depends_on_id":"ig-f4d","type":"blocks","created_at":"2026-01-31T22:01:03.931557+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-mbl","title":"define backend services needed to connect ElevenLabs Tools to our backend in order to fulfill the defined scope","status":"closed","priority":2,"issue_type":"task","owner":"windfox@gmx.de","created_at":"2026-01-31T15:46:28.756673465+01:00","created_by":"alissa","updated_at":"2026-01-31T16:22:15.957054706+01:00","closed_at":"2026-01-31T16:22:15.957054706+01:00","close_reason":"Closed"}
{"id":"ig-mit","title":"Replace in-memory queue with Aidbox Encounters","description":"Replace the hardcoded in-memory waiting queue with FHIR Encounter resources in Aidbox. Create a demo setup script that generates Encounters and schedules for the current day for hackathon demos.","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:49:14.088276+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:58:37.087582+01:00","closed_at":"2026-02-01T12:58:37.087582+01:00","close_reason":"Implemented Encounter-based queue with demo setup API"}
{"id":"ig-mnm","title":"OpenClaw Background Tasks - Post-call automation","description":"Implement OpenClaw agent for background tasks after call ends. Features: post-call webhook handler, verification SMS sending, staff WhatsApp alerts, call transcript analysis, AI confidence scoring, follow-up scheduling","status":"closed","priority":2,"issue_type":"feature","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:28.427099+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:50:34.748516+01:00","closed_at":"2026-02-06T08:50:34.748516+01:00","close_reason":"OpenClaw Background Tasks nicht mehr relevant für Ignis - wird in Mira mit Supervisor-Pattern neu konzipiert."}
{"id":"ig-muo","title":"Reconnect calendar to FHIR backend with SSE real-time sync","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:13:16.700682+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T12:26:42.918899+01:00","closed_at":"2026-02-01T12:26:42.918899+01:00","close_reason":"Implemented SSE real-time sync and API integration for appointments calendar"}
{"id":"ig-mv7","title":"[GLOBAL] GUI-Review Agent (Chrome DevTools MCP)","description":"Agent fuer visuelle UI-Verifikation via Chrome DevTools MCP.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/agents/gui-review/\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/agents/gui-review/\n- Chrome DevTools MCP Workflow ist stack-agnostisch\n- Agent muss URL/Port als Parameter bekommen (nicht hardcoded)\n- Screenshot + visuelle Verifikation + Accessibility-Check\n- Fuer Next.js: localhost:3000, Flet: localhost:PORT, etc.\n\n## Acceptance Criteria\n- [ ] Agent in globalem Claude-Config-Repo\n- [ ] URL/Port konfigurierbar (nicht hardcoded)\n- [ ] Screenshot-basierte UI-Verifikation\n- [ ] Accessibility-Grundcheck","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:36.583323+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:20.672096+01:00"}
{"id":"ig-mws","title":"[IGNIS] Projekt-Overview Standard fuer Subagents","description":"Ignis-spezifischer Projekt-Kontext als Standard fuer Subagent-Injection.\n\n## Kontext\nDas agent-briefing.md (ig-3ga, bereits erstellt) deckt das weitgehend ab.\nDieses Bead klaeren: Brauchen wir ein separates project/overview.md oder reicht agent-briefing.md?\n\n## Entscheidung\nagent-briefing.md ist bereits umfassend (API-Funktionen, Routes, Komponenten, FHIR-Daten, Test-Commands).\nEin separates overview.md waere Duplikation.\n\n## Acceptance Criteria\n- [ ] Entscheidung dokumentiert ob separates overview.md noetig","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:29.442176+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:46.086599+01:00","closed_at":"2026-02-06T15:31:46.086599+01:00","close_reason":"Nicht noetig: agent-briefing.md (ig-3ga) deckt Projekt-Overview vollstaendig ab. Separates overview.md waere Duplikation."}
{"id":"ig-nb7","title":"POST /api/auth/request-otp - Request OTP for Level 4 action confirmation","description":"Request a one-time password for Level 4 action confirmation. Sends SMS to patient's registered phone.\n\nInput: {\n  action: 'view_test_results' | 'download_records' | 'change_email'\n}\nOutput: {\n  success: boolean,\n  expiresIn: number,  // seconds (300 = 5 minutes)\n  maskedPhone: string // e.g. '+49 171 ****543'\n}\n\nRequires: Valid session token (Level 3) in Authorization header\n\nImplementation:\n1. Validate session is Level 3\n2. Verify action requires Level 4\n3. Get patient's phone from FHIR\n4. Generate 6-digit OTP, store hash with action context\n5. Send OTP via SMS\n6. OTP valid for 5 minutes, single use\n7. Rate limit: 3 OTP requests per hour\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:23:22.865893+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:28.977716+01:00","closed_at":"2026-02-06T08:51:28.977716+01:00","close_reason":"Auth Level 4 OTP zu ambitioniert fuer Ignis-Abschluss, wird in Mira neu konzipiert","dependencies":[{"issue_id":"ig-nb7","depends_on_id":"ig-bin","type":"blocks","created_at":"2026-01-31T22:01:27.18744+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-nrx","title":"ElevenLabs: Configure Phone Number Integration","description":"Configure phone number integration for the ElevenLabs Conversational AI agent.\n\n## Option A: ElevenLabs Phone Number (Recommended for testing)\n\n1. Go to agent settings → 'Phone' tab\n2. Click 'Get Phone Number'\n3. Select country: Germany (+49)\n4. Purchase or use trial number\n5. Note the number for testing\n\n## Option B: Twilio Integration (Production)\n\n1. Go to agent settings → 'Phone' tab\n2. Select 'Twilio' as provider\n3. Enter Twilio credentials:\n   - Account SID: from Twilio console\n   - Auth Token: from Twilio console\n4. Configure Twilio number to forward to ElevenLabs webhook\n5. In Twilio console:\n   - Go to Phone Numbers → Manage → Active Numbers\n   - Select your number\n   - Under 'Voice \u0026 Fax', set webhook to ElevenLabs URL\n\n## Option C: SIP Trunk (Enterprise)\n\n1. Go to agent settings → 'Phone' tab\n2. Select 'SIP' as provider\n3. Configure SIP trunk settings from your VoIP provider\n4. Set up call routing to ElevenLabs\n\n## Caller-ID Configuration\n\nIMPORTANT: Ensure Caller-ID is passed to the agent:\n1. In phone settings, enable 'Pass caller ID to agent'\n2. The caller's phone number will be available as a conversation variable\n3. Configure identify_patient tool to use this variable\n\n## Testing\n\n1. Call the configured number\n2. Verify:\n   - Call connects to ElevenLabs agent\n   - identify_patient tool receives correct phone number\n   - Audio quality is acceptable\n\n## Verification\n- Phone number is active and connected\n- Test call reaches the agent\n- Caller-ID is correctly passed to tools\n\nSee ElevenLabs docs: https://elevenlabs.io/docs/conversational-ai/phone-integration","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:28:16.44722+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:57:18.061078+01:00","closed_at":"2026-02-01T11:57:18.061078+01:00","close_reason":"Verified via ElevenLabs API - agent fully configured with system prompt, 9 tools, and Twilio phone integration","dependencies":[{"issue_id":"ig-nrx","depends_on_id":"ig-4tp","type":"blocks","created_at":"2026-01-31T22:00:42.074706+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-p8y","title":"Backend: ElevenLabs Chat Session Endpoints","description":"Create /api/chat/* endpoints for managing text-based chat sessions with ElevenLabs","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:24:51.699204+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:15:21.890432+01:00","closed_at":"2026-02-01T10:41:56.706901+01:00","close_reason":"Closed","dependencies":[{"issue_id":"ig-p8y","depends_on_id":"ig-e4h","type":"parent-child","created_at":"2026-02-01T10:25:01.404865+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-pfb","title":"ElevenLabs Voice Flow - Complete 3-tier triage integration","description":"Complete ElevenLabs voice conversation flow with full 3-tier triage logic. Wire up: returning patient lookup, triage classification (Emergency/Urgent/Regular), appointment booking, urgent queue handling, German conversation prompts, tool integration with backend APIs","status":"closed","priority":1,"issue_type":"feature","owner":"sven@sven-s.de","created_at":"2026-02-01T12:13:26.959472+01:00","created_by":"Sven Sönnichsen","updated_at":"2026-02-06T08:53:14.028254+01:00","closed_at":"2026-02-06T08:53:14.028254+01:00","close_reason":"9 Tools konfiguriert, System Prompt v2.1 mit 3-Tier Triage live, alle Backend-APIs angebunden. Testing wird separat in ig-el7 getrackt."}
{"id":"ig-pvu","title":"Fragebogen-Status in Warteschlange und Termine anzeigen","description":"Die QuestionnaireStatus-Badges (Ausgefüllt/In Bearbeitung/Ausstehend) werden bisher nur in der PatientTable angezeigt. Sie müssen auch in diesen Views sichtbar sein:\n\n1. **Wartezimmer** (wartezimmer/page.tsx) - PatientRow braucht Fragebogen-Badge\n2. **Dashboard Warteschlange** (dashboard-waiting-queue.tsx) - kompakte Ansicht\n3. **Nächste Termine** (upcoming-appointments.tsx) - Badge pro Termin\n\n## Ansatz\n- QuestionnaireStatusBadge aus patient-table.tsx in eigene Komponente extrahieren (questionnaire-status-badge.tsx)\n- In allen 3 Views einbauen (patientId ist überall verfügbar)\n- Klick öffnet QuestionnaireResponseModal (bereits vorhanden)\n\n## Dateien\n- NEU: frontend/components/questionnaire-status-badge.tsx (extrahiert aus patient-table.tsx)\n- NEU: frontend/components/questionnaire-status-badge.test.tsx\n- EDIT: frontend/components/patient-table.tsx (Badge-Import umstellen)\n- EDIT: frontend/app/wartezimmer/page.tsx (Badge in PatientRow)\n- EDIT: frontend/components/dashboard-waiting-queue.tsx (Badge in Zeile)\n- EDIT: frontend/components/upcoming-appointments.tsx (Badge pro Termin)","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:04:16.427995+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T10:08:13.540584+01:00","closed_at":"2026-02-06T10:08:13.540584+01:00","close_reason":"QuestionnaireStatusBadge extrahiert, in Wartezimmer/Dashboard-Queue/Nächste Termine integriert, 150 Tests grün"}
{"id":"ig-q6r","title":"[SCAFFOLD] /inject-standards Command fuer Subagent-Prompts","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:34.030222+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:30.212427+01:00","closed_at":"2026-02-06T15:31:30.212427+01:00","close_reason":"Bereits vorhanden: /inject-standards Skill existiert global. Kein separates Ignis-Command noetig."}
{"id":"ig-qz5","title":"Code-Analyse: Anti-Patterns und Refactoring-Kandidaten identifizieren","description":"Komplette Codebase-Analyse um technische Schulden, Anti-Patterns und Verbesserungspotential zu identifizieren.\n\n## Scope\nBackend (src/) und Frontend (frontend/) durchgehen auf:\n\n### Backend\n- Duplizierter Code (z.B. transformQueueEntry in mehreren Dateien?)\n- Inkonsistente Error-Handling-Patterns\n- Stub-Endpoints die noch nicht implementiert sind\n- Fehlende Validierung\n- FHIR-Client Usage-Patterns (konsistent?)\n- Test-Coverage-Luecken\n\n### Frontend\n- Duplizierte Komponenten-Logik (z.B. transformQueueEntry in wartezimmer UND dashboard)\n- Inkonsistente State-Management-Patterns\n- Fehlende Error Boundaries\n- API-Client Patterns (konsistent?)\n- Component-Groesse (zu grosse Dateien die gesplittet werden sollten?)\n- Accessibility-Luecken\n\n### Uebergreifend\n- TypeScript strictness (any-Usage, fehlende Types)\n- Konsistenz zwischen Backend-Types und Frontend-Types (Duplikation?)\n- Shared Types/Interfaces die extrahiert werden koennten\n- Env-Var Management\n- Logging-Strategie\n\n## Output\nListe von Refactoring-Beads mit Prioritaet, jeweils als eigenes Bead angelegt.","notes":"## Analysis Complete - 22 Findings\n\n### Backend Duplications (P2)\n1. ig-6yy: todayBerlin() in 4 files\n2. ig-bhu: getPatientById() in 2 files\n3. ig-4be: patientDisplayName() in 3 places\n4. ig-2sp: FHIRBundle interface in 4+ files\n\n### Backend Duplications (P3)\n5. ig-at1: normalizePhone() in 2 files\n6. ig-18e: extractPatientId() in 2 files\n7. ig-06o: SSE broadcaster duplicated logic\n\n### Backend Issues (P2)\n8. ig-sto: Hardcoded dev credentials/secrets as defaults\n\n### Backend Issues (P3)\n9. ig-4gn: Inconsistent validation (zValidator vs manual)\n10. ig-0qp: TypeScript any usage in 3 locations\n11. ig-vfr: In-memory stores without persistence warnings\n12. ig-9xd: String matching for error categorization\n\n### Backend Issues (P4)\n13. ig-asv: 3 stub endpoints returning empty arrays\n14. ig-c4k: API version hardcoded as 0.1.0 (should be 0.2.0)\n\n### Frontend Duplications (P2)\n15. ig-e16: transformQueueEntry in wartezimmer + dashboard\n16. ig-coa: priorityConfig/statusConfig duplicated\n17. ig-8yb: Queue fetching/polling logic duplicated\n18. ig-9tb: progressStatus/cyclePriority duplicated\n\n### Frontend Issues (P3)\n19. ig-txm: WaitingPatient interface duplicated\n20. ig-62y: FHIRPatient type mismatch backend/frontend\n\n### Frontend Issues (P4)\n21. ig-gme: 5 unused font imports in layout.tsx\n22. ig-8u9: appointments-store.ts possibly unused\n\n### Cross-Cutting (P2)\n23. ig-dr1: No shared types between backend/frontend\n\n### Cross-Cutting (P4)\n24. ig-rpm: API client lacks centralized error handling","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:44:11.648198+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:02:20.986846+01:00","closed_at":"2026-02-06T11:02:20.986846+01:00","close_reason":"22 refactoring beads created: 8x P2 (critical duplications/security), 8x P3 (consistency issues), 6x P4 (cleanup). Covers backend (14), frontend (8), cross-cutting (2)."}
{"id":"ig-rpm","title":"[REFACTOR] Frontend API client lacks centralized error handling","description":"frontend/lib/api.ts has ~20 API functions all following the same pattern: fetch, check res.ok, throw Error, return res.json(). No centralized error interceptor, retry logic, or error transformation. Consider a shared fetchAPI wrapper.","status":"open","priority":4,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:02:02.823001+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:02:02.823001+01:00"}
{"id":"ig-ru4","title":"ElevenLabs: Configure System Prompt","description":"Configure the system prompt for the Ignis Conversational AI agent in ElevenLabs.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'System Prompt'\n3. Paste the following prompt:\n\n```\nYou are a friendly phone assistant for the medical practice 'Praxis Dr. Müller'.\n\n## Initial Greeting\nAt the start of every call, immediately use the identify_patient tool with the caller's phone number.\n- If patient found: 'Guten Tag, [Name]! Wie kann ich Ihnen helfen?'\n- If not found: 'Guten Tag! Mit wem spreche ich bitte?'\n\n## Authentication Flow\nBefore performing any action:\n1. Use authorize_action to check if current auth level is sufficient\n2. If not authorized, ask for the missing factors:\n   - Level 1 needs: date of birth\n   - Level 2 needs: date of birth + postal code\n   - Level 3 needs: date of birth + postal code + street name\n3. Use authenticate_patient to verify the factors\n4. Only proceed with action if authenticated is true\n\n## Handling Date of Birth\nWhen the patient says their date of birth:\n- Convert spoken format to YYYY-MM-DD\n- Example: '22. August 1972' → '1972-08-22'\n- Example: 'zweiundzwanzigster achter zweiundsiebzig' → '1972-08-22'\n\n## Security Rules\n- NEVER reveal medical information without Level 3 authentication\n- NEVER perform actions without proper authentication level\n- After 3 failed authentication attempts, say: 'Bitte wenden Sie sich direkt an unsere Praxis während der Öffnungszeiten.'\n- If patient wants to change their email address, say: 'Aus Sicherheitsgründen können Sie Ihre E-Mail-Adresse nur persönlich in der Praxis ändern.'\n- Level 4 actions (test results, records): 'Für diese Information muss ich Sie an unser Praxispersonal weiterleiten.'\n\n## Language\nSpeak German unless the patient speaks another language.\nBe friendly, professional, and concise. This is a phone call - keep responses short.\n```\n\n4. Save the configuration\n\n## Verification\n- System prompt is saved\n- Test conversation follows the defined flow\n\nSee docs/AUTHENTICATION-POLICY.md for full authentication specification.","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:27:45.994294+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T11:57:17.992841+01:00","closed_at":"2026-02-01T11:57:17.992841+01:00","close_reason":"Verified via ElevenLabs API - agent fully configured with system prompt, 9 tools, and Twilio phone integration","dependencies":[{"issue_id":"ig-ru4","depends_on_id":"ig-4tp","type":"blocks","created_at":"2026-01-31T22:00:41.897143+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-sgy","title":"POST /api/auth/confirm-action - Confirm Level 4 action with OTP","description":"Confirm a Level 4 action by providing the OTP sent via SMS. Returns Level 4 JWT with short expiry and action scope.\n\n## Single JWT Design\nReturns a Level 4 JWT that:\n- Has short expiry (5 minutes)\n- Is scoped to a specific action\n- Replaces the current token temporarily\n\n## Request\n```typescript\nPOST /api/auth/confirm-action\nHeaders: Authorization: Bearer \u003clevel-3-jwt\u003e\n{\n  \"otp\": string,        // 6-digit code from SMS\n  \"action\": string      // Must match action from request-otp\n}\n```\n\n## Response\n```typescript\n{\n  \"jwt\": string,            // Level 4 JWT (5 min expiry)\n  \"level\": 4,\n  \"expiresAt\": string,      // ~5 minutes from now\n  \"actionScope\": string     // e.g., \"view_test_results\"\n}\n```\n\n## JWT Payload\n```typescript\n{\n  \"sub\": \"patient-2\",\n  \"level\": 4,\n  \"exp\": \u003cnow + 5 min\u003e,\n  \"actionScope\": \"view_test_results\"  // Only valid for this action\n}\n```\n\n## Implementation Steps\n1. Verify current session is Level 3\n2. Lookup OTP hash for this session + action\n3. Verify OTP matches and not expired (5 min window)\n4. Check attempt count (max 5)\n5. Mark OTP as used\n6. Sign Level 4 JWT with:\n   - Short expiry (5 min)\n   - actionScope claim\n7. Return JWT\n\n## Frontend Flow\n1. User initiates sensitive action (view test results)\n2. Backend returns 403 + requiredLevel: 4\n3. Frontend calls /auth/request-otp\n4. User receives SMS, enters OTP\n5. Frontend calls /auth/confirm-action\n6. Frontend receives Level 4 JWT\n7. Frontend immediately uses JWT to call protected endpoint\n8. After action, frontend can discard Level 4 JWT and keep Level 3\n\n## Error Responses\n- 401 `invalid_otp`: OTP doesn't match\n- 401 `expired_otp`: OTP expired (5 min window)\n- 400 `action_mismatch`: OTP was requested for different action\n- 429 `max_attempts`: 5 failed attempts, must request new OTP\n\nSee docs/AUTHENTICATION-POLICY.md for full specification.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:23:23.834951+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.064213+01:00","closed_at":"2026-02-06T08:51:29.064213+01:00","close_reason":"Abhaengig von ig-nb7, Auth Level 4 wird in Mira weiterverfolgt","dependencies":[{"issue_id":"ig-sgy","depends_on_id":"ig-nb7","type":"blocks","created_at":"2026-01-31T22:01:27.257979+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-sto","title":"[REFACTOR] Hardcoded dev credentials/secrets as config defaults","description":"Security concern: (1) src/lib/config.ts has admin/ignis2026 as default AIDBOX_USER/PASSWORD, (2) src/lib/jwt.ts has 'ignis-dev-secret-change-me' as default JWT_SECRET, (3) src/middleware/voice-api-key.ts has 'dev-voice-api-key' as default. These should fail loudly if not configured rather than falling back to dev values.","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:27.539035+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:27.539035+01:00"}
{"id":"ig-swo","title":"Feature: Doctor View - Patient Questionnaire Status","description":"Allow frontdesk staff to see questionnaire completion status for patients and view filled responses in a modal","design":"-","status":"closed","priority":2,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T10:29:11.142339+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:23.073316+01:00","closed_at":"2026-02-06T09:21:23.073316+01:00","close_reason":"Alle 3 Children fertig: Backend GET Endpoint, PatientTable Status-Badges, QuestionnaireResponseModal"}
{"id":"ig-tjz","title":"Lerneffekte aus Zahnrad-Scaffold auf Ignis uebertragen","description":"Analyse des .claude/ Scaffolds in ~/code/zahnrad und Adaption relevanter Patterns fuer Ignis (TypeScript/Next.js/Bun).\n\nZahnrad hat folgende Strukturen die wir evaluieren sollen:\n1. **standards/index.yml** mit Trigger-basiertem Standard-Loading (dataprovider-test-patterns, abc-structure, compliance/check-structure, flet/development, project/overview)\n2. **hooks/dod-reminder.md** - PreToolUse Hook der bei git commit an DoD erinnert\n3. **hooks/docs-check.md** - PreToolUse Hook der bei Write/Edit in docs/ Aenderungen prueft\n4. **commands/dod.md** - Definition of Done Command mit 6 Checks (tests, linting, type checking, docs, security, GUI review)\n5. **agents/** - tdd-orchestrator, gui-review, tdd-phase-a, tdd-phase-b, changelog-updater\n6. **skills/** - flet-gui-testing, flet-test, tdd-migration\n\nAcceptance Criteria:\n- [ ] Zahnrad .claude/ Struktur vollstaendig analysiert\n- [ ] Relevante Patterns fuer Ignis identifiziert (TypeScript/Next.js Kontext)\n- [ ] standards/index.yml fuer Ignis erstellt oder erweitert\n- [ ] Mindestens DoD-Hook und DoD-Command adaptiert\n- [ ] TDD-Orchestrator Agent fuer Ignis angepasst (Bun Test + Vitest statt pytest)\n- [ ] Entscheidungen dokumentiert welche Zahnrad-Patterns nicht uebernommen werden und warum","notes":"## Zahnrad Scaffold Analyse\n\n### ADOPT (direkt uebernehmen - Konzept 1:1 uebertragbar)\nKeines - alle relevanten Patterns brauchen Anpassung an TypeScript/Next.js\n\n### ADAPT (anpassen fuer TypeScript/Next.js)\n1. standards/index.yml (Trigger-basiertes Standard-System) -\u003e ig-xpy\n2. git/conventional-commits (Commit-Konvention) -\u003e ig-lwx\n3. project/overview (Projekt-Kontext fuer Subagents) -\u003e ig-mws\n4. project/team-workflow (Infrastructure-First Pattern) -\u003e ig-6aj\n5. hooks/dod-reminder (DoD-Erinnerung vor bd close) -\u003e ig-l7l\n6. hooks/docs-check (Changelog-Pruefung bei Code-Aenderungen) -\u003e ig-yx2\n7. commands/dod (Definition of Done Pruefung) -\u003e ig-2k6\n8. commands/inject-standards (Standards fuer Subagents laden) -\u003e ig-q6r\n9. commands/refactor-note (Refactoring-Notizen als Beads) -\u003e ig-ell\n10. agents/changelog-updater (Auto-Changelog aus Beads) -\u003e ig-4ol\n11. agents/gui-review (Visuelle GUI-Verifikation) -\u003e ig-mv7\n\n### SKIP (nicht relevant fuer Ignis)\n1. python/style - Python-spezifisch, Ignis nutzt TypeScript\n2. python/python314-patterns - Python 3.14 Features, irrelevant\n3. python/dependency-injection - CommandRunner DI, Python-spezifisch\n4. python/dataprovider-test-patterns - MockSystemDataProvider, Python-spezifisch\n5. python/mock-command-runner - Legacy Python mock, irrelevant\n6. python/abc-structure - Python ABC Pattern, irrelevant\n7. python/module-structure - Python Modul-Aufbau, irrelevant\n8. python/language-convention - Deutsch/Englisch Konvention fuer Python, irrelevant\n9. powershell/style - PowerShell 5.1 Style, irrelevant\n10. compliance/check-structure - Zahnrad domain-spezifisch (Zahnarztpraxen)\n11. flet/development - Flet GUI Framework, Ignis nutzt Next.js\n12. flet/ecosystem - Flet Packages, irrelevant\n13. flet/testing - Flet Testing, irrelevant\n14. flet/view-pattern - Flet View Struktur, irrelevant\n15. agents/tdd-orchestrator - PowerShell-\u003ePython Migration, irrelevant\n16. agents/tdd-phase-a - TDD Red Phase fuer PS Migration, irrelevant\n17. agents/tdd-phase-b - TDD Green Phase fuer PS Migration, irrelevant\n18. skills/flet-gui-testing - Flet Browser Testing, irrelevant\n19. skills/flet-test - Flet Web Testing, irrelevant\n20. skills/tdd-migration - PS-\u003ePython TDD Workflow, irrelevant","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:46:38.798042+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T10:59:58.03871+01:00","closed_at":"2026-02-06T10:59:58.03871+01:00","close_reason":"Analyse abgeschlossen: 0 ADOPT, 11 ADAPT, 20 SKIP. 11 Beads erstellt (ig-xpy, ig-lwx, ig-mws, ig-6aj, ig-l7l, ig-yx2, ig-2k6, ig-q6r, ig-ell, ig-4ol, ig-mv7)."}
{"id":"ig-tre","title":"Persist patient notes to backend API","description":"Backend: Add POST /api/patients/:id/notes endpoint. Frontend: patient-notes.tsx saves locally only - update to POST new notes and PUT edits to API.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T12:17:13.655248+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T09:21:14.657545+01:00","closed_at":"2026-02-06T09:21:14.657545+01:00","close_reason":"Patient Notes FHIR Communication Backend (POST/PUT/GET) + Frontend API-Integration, 17 Tests"}
{"id":"ig-txm","title":"[REFACTOR] Frontend: WaitingPatient interface duplicated with slight field differences","description":"WaitingPatient interface defined in both frontend/app/wartezimmer/page.tsx and frontend/components/dashboard-waiting-queue.tsx with slightly different optional fields. Consolidate to single shared type.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:44.10856+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:44.10856+01:00"}
{"id":"ig-vfr","title":"[REFACTOR] In-memory stores without persistence or scaling warnings","description":"Multiple in-memory Maps used for state: (1) src/lib/auth-tokens.ts - token store and rate limiting, (2) src/lib/aidbox-voice.ts - auth attempt tracking, (3) src/lib/chat-session.ts - chat sessions. These are lost on restart and don't scale horizontally. Add documentation/warnings or consider Redis/persistent alternatives.","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T11:01:30.507872+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T11:01:30.507872+01:00"}
{"id":"ig-wfi","title":"Voice-Interaktion: Datenschutz-Konzept","description":"Datenschutz-Konzept für Voice-Interaktion in der Praxis.\n\n## Problem (von Dirk Säger)\n- Schweigepflicht: Man hört oft was im Nebenzimmer passiert\n- Wo bleiben die Daten bei Cloud-Services?\n\n## Lösungsansätze\n\n### Hardware\n- Knopf im Ohr (In-Ear-Kopfhörer)\n- Smart Glasses mit Privatem Display\n- Einschränkung: Smart Glasses für jüngere Kollegen ohne Augenkorrektur/Lupenbrille\n\n### Software-Architektur\n- Lokal gehosteter Agent für Produktiveinsatz\n- Text-to-Speech lokal (z.B. Piper, Coqui TTS)\n- Speech-to-Text lokal (z.B. Whisper)\n- LLM lokal (z.B. Llama, Mistral)\n\n### Hackathon-Ansatz\n- ElevenLabs für Voice (Cloud)\n- Bewusstsein: Vor Praxiseinsatz auf lokales Modell umstellen\n- Demo-Modus mit Pseudo-Daten\n\n## Zu klären\n- Welche lokalen Modelle sind ausreichend performant?\n- Hardware-Anforderungen für lokalen Betrieb\n- Latenz-Anforderungen für flüssige Interaktion","status":"closed","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-01T08:04:35.548428+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:19.055435+01:00","closed_at":"2026-02-06T08:51:19.055437+01:00","dependencies":[{"issue_id":"ig-wfi","depends_on_id":"ig-03x","type":"blocks","created_at":"2026-02-01T08:04:47.591344+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-wuf","title":"ElevenLabs: Configure change_phone_number Tool","description":"Configure the change_phone_number tool to update patient contact info.\n\n## Steps\n\n1. Open the agent in ElevenLabs dashboard\n2. Go to 'Agent' tab → 'Tools'\n3. Click 'Add Tool' → 'Custom Tool'\n4. Configure:\n\n**Name:** change_phone_number\n\n**Description:**\nUpdate the patient's phone number in their record. Requires Level 2 authentication. Always confirm the new number by reading it back before saving.\n\n**Parameters:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"patient_id\": {\n      \"type\": \"string\",\n      \"description\": \"The patient ID from identify_patient\"\n    },\n    \"new_phone\": {\n      \"type\": \"string\",\n      \"description\": \"New phone number in E.164 format\"\n    },\n    \"auth_level\": {\n      \"type\": \"integer\",\n      \"description\": \"Current authentication level (must be \u003e= 2)\"\n    }\n  },\n  \"required\": [\"patient_id\", \"new_phone\", \"auth_level\"]\n}\n```\n\n**Endpoint Configuration:**\n- URL: https://ignis.cognovis.de/api/patients/${patient_id}/phone\n- Method: PATCH\n- Headers:\n  - Authorization: Bearer ${IGNIS_API_KEY}\n  - Content-Type: application/json\n\n## Expected Response\n```json\n{\n  \"success\": true,\n  \"message\": \"Phone number updated\"\n}\n```\n\n## Voice Flow\n1. Verify identity to Level 2\n2. Ask for new phone number\n3. Read back: 'Die neue Nummer ist 0171-9876543. Ist das korrekt?'\n4. On confirmation, call this tool\n5. 'Ihre Telefonnummer wurde aktualisiert.'\n\n## Authentication\nRequires Level 2 (birth date + postal code verified).\n\n## Backend Note\nThis tool requires a new endpoint: PATCH /api/patients/:id/phone\nSee docs/AUTHENTICATION-POLICY.md for security requirements.","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:29:33.394438+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T08:51:29.486179+01:00","closed_at":"2026-02-06T08:51:29.486179+01:00","close_reason":"change_phone_number Tool ist nice-to-have, Kernflow funktioniert ohne","dependencies":[{"issue_id":"ig-wuf","depends_on_id":"ig-f4d","type":"blocks","created_at":"2026-01-31T22:01:04.258523+01:00","created_by":"Malte Sussdorff"}]}
{"id":"ig-xpy","title":"[SCAFFOLD] Standards-Index mit Trigger-System (.claude/standards/index.yml)","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:27.648231+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:31.458027+01:00","closed_at":"2026-02-06T15:31:31.458027+01:00","close_reason":"Bereits vorhanden: ~/code/claude/malte/standards/index.yml existiert mit Trigger-System. Ignis-Trigger wurden in dieser Session hinzugefuegt."}
{"id":"ig-yx2","title":"[GLOBAL] Docs-Check Hook (Changelog bei Code-Aenderungen)","description":"PreToolUse Hook der bei Code-Aenderungen prueft ob Changelog/Docs auch aktualisiert wurden.\n\n## Ziel-Ort\nGlobal: ~/code/claude/malte/hooks/docs-check.md\n\n## Adaption von Zahnrad\nZahnrad-Vorlage: ~/code/zahnrad/.claude/hooks/docs-check.md\n- Mechanismus ist stack-agnostisch: Wenn Code sich aendert, Changelog-Update erinnern\n- Dateimuster (*.py, *.ts, *.swift) muessen generisch oder konfigurierbar sein\n- Changelog-Pfad: CHANGELOG.md (Standard fuer alle Projekte)\n\n## Acceptance Criteria\n- [ ] Hook in globalem Claude-Config-Repo erstellt\n- [ ] Erkennt Code-Aenderungen unabhaengig vom Stack\n- [ ] Erinnert an CHANGELOG.md Update","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-06T10:59:32.320808+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-06T15:31:06.980052+01:00"}
{"id":"ig-zoz","title":"ElevenLabs: Configure API Key and Webhook Security","description":"Configure API authentication between ElevenLabs and Ignis backend.\n\n## Step 1: Generate Ignis API Key\n\n1. Generate a secure API key for ElevenLabs:\n   ```bash\n   openssl rand -base64 32\n   ```\n2. Add to Ignis backend environment:\n   ```\n   ELEVENLABS_WEBHOOK_API_KEY=\u003cgenerated-key\u003e\n   ```\n3. Implement API key validation middleware in Hono\n\n## Step 2: Configure in ElevenLabs\n\n1. Go to agent settings → 'Tools'\n2. For each tool (identify_patient, authenticate_patient, authorize_action):\n   - Edit the tool\n   - In Headers section, add:\n     - Key: Authorization\n     - Value: Bearer \u003cyour-api-key\u003e\n3. Save each tool\n\n## Step 3: Webhook Signature Verification (Optional but Recommended)\n\nElevenLabs signs webhook requests. To verify:\n\n1. Get webhook secret from ElevenLabs dashboard\n2. Add to Ignis environment:\n   ```\n   ELEVENLABS_WEBHOOK_SECRET=\u003cwebhook-secret\u003e\n   ```\n3. Implement signature verification:\n   ```typescript\n   function verifyWebhookSignature(request: Request, secret: string): boolean {\n     const signature = request.headers.get('x-elevenlabs-signature');\n     const body = await request.text();\n     const expected = crypto\n       .createHmac('sha256', secret)\n       .update(body)\n       .digest('hex');\n     return signature === expected;\n   }\n   ```\n\n## Step 4: IP Allowlisting (Optional)\n\nFor additional security, allowlist ElevenLabs IP ranges:\n1. Check ElevenLabs documentation for current IP ranges\n2. Configure firewall/load balancer to only accept requests from these IPs\n\n## Verification\n\n1. Make test call\n2. Check Ignis logs:\n   - Request has valid Authorization header\n   - Signature verification passes (if implemented)\n3. Reject a request with invalid API key - should return 401\n\n## Security Checklist\n- [ ] API key generated and stored securely\n- [ ] API key configured in all ElevenLabs tools\n- [ ] Middleware validates API key on all /api/voice/* endpoints\n- [ ] API key not committed to git\n- [ ] API key rotated if compromised","status":"closed","priority":1,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-01-31T21:28:28.770672+01:00","created_by":"Malte Sussdorff","updated_at":"2026-02-01T09:39:59.214588+01:00","closed_at":"2026-02-01T08:26:21.583034108+01:00","dependencies":[{"issue_id":"ig-zoz","depends_on_id":"ig-4tp","type":"blocks","created_at":"2026-01-31T22:00:41.994124+01:00","created_by":"Malte Sussdorff"}]}
